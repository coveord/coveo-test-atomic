{"version":3,"names":["AtomicProductTemplate","constructor","hostRef","this","conditions","mustMatch","mustNotMatch","productTemplateCommon","ProductTemplateCommon","host","setError","err","error","validParents","allowEmpty","componentWillLoad","matchConditions","makeMatchConditions","getTemplate","render","renderIfError","__decorate","MapProp","splitValues"],"sources":["src/components/commerce/product-template/atomic-product-template.tsx"],"sourcesContent":["import {\n  ProductTemplate,\n  ProductTemplateCondition,\n} from '@coveo/headless/commerce';\nimport {Component, Element, Prop, Method, State} from '@stencil/core';\nimport {MapProp} from '../../../utils/props-utils';\nimport {\n  ProductTemplateCommon,\n  makeMatchConditions,\n} from './product-template-common';\n\n/**\n * @internal\n */\n@Component({\n  tag: 'atomic-product-template',\n  shadow: true,\n})\nexport class AtomicProductTemplate {\n  private productTemplateCommon: ProductTemplateCommon;\n\n  @State() public error!: Error;\n\n  @Element() public host!: HTMLDivElement;\n\n  /**\n   * A function that must return true on products for the product template to apply.\n   * Set programmatically before initialization, not via attribute.\n   *\n   * For example, the following targets a template and sets a condition to make it apply only to products whose `ec_name` contains `singapore`:\n   * `document.querySelector('#target-template').conditions = [(product) => /singapore/i.test(product.ec_name)];`\n   */\n  @Prop() public conditions: ProductTemplateCondition[] = [];\n\n  @MapProp({splitValues: true}) public mustMatch: Record<string, string[]> = {};\n\n  @MapProp({splitValues: true}) public mustNotMatch: Record<string, string[]> =\n    {};\n\n  constructor() {\n    this.productTemplateCommon = new ProductTemplateCommon({\n      host: this.host,\n      setError: (err) => {\n        this.error = err;\n      },\n      validParents: [\n        'atomic-commerce-product-list',\n        'atomic-commerce-recommendation-list',\n        'atomic-commerce-search-box-instant-products',\n      ],\n      allowEmpty: true,\n    });\n  }\n\n  public componentWillLoad() {\n    this.productTemplateCommon.matchConditions = makeMatchConditions(\n      this.mustMatch,\n      this.mustNotMatch\n    );\n  }\n\n  /**\n   * Gets the product template to apply based on the evaluated conditions.\n   */\n  @Method()\n  public async getTemplate(): Promise<ProductTemplate<DocumentFragment> | null> {\n    return this.productTemplateCommon.getTemplate(this.conditions, this.error);\n  }\n\n  public render() {\n    return this.productTemplateCommon.renderIfError(this.error);\n  }\n}\n"],"mappings":"2nBAkBaA,EAAqB,MAqBhC,WAAAC,CAAAC,G,UAPeC,KAAAC,WAAyC,GAEnBD,KAAAE,UAAsC,GAEtCF,KAAAG,aACnC,G,qCALsD,GAQtDH,KAAKI,sBAAwB,IAAIC,EAAsB,CACrDC,KAAMN,KAAKM,KACXC,SAAWC,IACTR,KAAKS,MAAQD,CAAG,EAElBE,aAAc,CACZ,+BACA,sCACA,+CAEFC,WAAY,M,CAIT,iBAAAC,GACLZ,KAAKI,sBAAsBS,gBAAkBC,EAC3Cd,KAAKE,UACLF,KAAKG,a,CAQF,iBAAMY,GACX,OAAOf,KAAKI,sBAAsBW,YAAYf,KAAKC,WAAYD,KAAKS,M,CAG/D,MAAAO,GACL,OAAOhB,KAAKI,sBAAsBa,cAAcjB,KAAKS,M,6BApClBS,EAAA,CAApCC,EAAQ,CAACC,YAAa,Q,gCAEcF,EAAA,CAApCC,EAAQ,CAACC,YAAa,Q"}