{"version":3,"names":["atomicCommerceRefineToggleCss","AtomicCommerceRefineToggleStyle0","AtomicCommerceRefineToggle","initialize","searchOrListing","this","bindings","interfaceElement","type","buildSearch","engine","buildProductListing","summary","loadModal","modalRef","document","createElement","host","insertAdjacentElement","openButton","buttonRef","enableModal","isOpen","render","h","RefineToggleGuard","key","firstRequestExecuted","summaryState","hasError","hasItems","hasProducts","RefineToggleButton","i18n","onClick","setRef","button","__decorate","BindStateToController","InitializeBindings"],"sources":["src/components/commerce/atomic-commerce-refine-toggle/atomic-commerce-refine-toggle.pcss?tag=atomic-commerce-refine-toggle&encapsulation=shadow","src/components/commerce/atomic-commerce-refine-toggle/atomic-commerce-refine-toggle.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {\n  buildProductListing,\n  buildSearch,\n  Summary,\n  SearchSummaryState,\n  ProductListingSummaryState,\n} from '@coveo/headless/commerce';\nimport {Component, h, State, Element} from '@stencil/core';\nimport {\n  InitializeBindings,\n  InitializableComponent,\n  BindStateToController,\n} from '../../../utils/initialization-utils';\nimport {RefineToggleButton} from '../../common/refine-modal/button';\nimport {RefineToggleGuard} from '../../common/refine-modal/guard';\nimport {CommerceBindings} from '../atomic-commerce-interface/atomic-commerce-interface';\n\n/**\n * The `atomic-commerce-refine-toggle` component displays a button that opens a modal containing the facets and the sort components.\n *\n * When this component is added to the `atomic-commerce-search-interface`, an `atomic-commerce-refine-modal` component is automatically created.\n\n * @part button - The refine toggle button.\n *\n * @alpha\n */\n@Component({\n  tag: 'atomic-commerce-refine-toggle',\n  styleUrl: 'atomic-commerce-refine-toggle.pcss',\n  shadow: true,\n})\nexport class AtomicCommerceRefineToggle\n  implements InitializableComponent<CommerceBindings>\n{\n  public summary!: Summary;\n  @BindStateToController('summary')\n  @State()\n  private summaryState!: SearchSummaryState | ProductListingSummaryState;\n  @Element() public host!: HTMLElement;\n  private modalRef?: HTMLAtomicCommerceRefineModalElement;\n  private buttonRef?: HTMLButtonElement;\n\n  @InitializeBindings() public bindings!: CommerceBindings;\n  @State() public error!: Error;\n\n  public initialize() {\n    const searchOrListing =\n      this.bindings.interfaceElement.type === 'search'\n        ? buildSearch(this.bindings.engine)\n        : buildProductListing(this.bindings.engine);\n\n    this.summary = searchOrListing.summary();\n  }\n\n  private loadModal() {\n    if (this.modalRef) {\n      return;\n    }\n\n    this.modalRef = document.createElement('atomic-commerce-refine-modal');\n    this.host.insertAdjacentElement('beforebegin', this.modalRef);\n    this.modalRef.openButton = this.buttonRef;\n  }\n\n  private enableModal() {\n    this.modalRef && (this.modalRef.isOpen = true);\n  }\n\n  public render() {\n    return (\n      <RefineToggleGuard\n        firstRequestExecuted={this.summaryState.firstRequestExecuted}\n        hasError={this.summaryState.hasError}\n        hasItems={this.summaryState.hasProducts}\n      >\n        <RefineToggleButton\n          i18n={this.bindings.i18n}\n          onClick={() => this.enableModal()}\n          setRef={(button) => {\n            if (!button) {\n              return;\n            }\n            this.buttonRef = button;\n            this.loadModal();\n          }}\n        />\n      </RefineToggleGuard>\n    );\n  }\n}\n"],"mappings":"8TAAA,MAAMA,EAAgC,wguCACtC,MAAAC,EAAeD,E,iXC8BFE,EAA0B,M,0EAc9B,UAAAC,GACL,MAAMC,EACJC,KAAKC,SAASC,iBAAiBC,OAAS,SACpCC,EAAYJ,KAAKC,SAASI,QAC1BC,EAAoBN,KAAKC,SAASI,QAExCL,KAAKO,QAAUR,EAAgBQ,S,CAGzB,SAAAC,GACN,GAAIR,KAAKS,SAAU,CACjB,M,CAGFT,KAAKS,SAAWC,SAASC,cAAc,gCACvCX,KAAKY,KAAKC,sBAAsB,cAAeb,KAAKS,UACpDT,KAAKS,SAASK,WAAad,KAAKe,S,CAG1B,WAAAC,GACNhB,KAAKS,WAAaT,KAAKS,SAASQ,OAAS,K,CAGpC,MAAAC,GACL,OACEC,EAACC,EAAiB,CAAAC,IAAA,2CAChBC,qBAAsBtB,KAAKuB,aAAaD,qBACxCE,SAAUxB,KAAKuB,aAAaC,SAC5BC,SAAUzB,KAAKuB,aAAaG,aAE5BP,EAACQ,EAAkB,CAAAN,IAAA,2CACjBO,KAAM5B,KAAKC,SAAS2B,KACpBC,QAAS,IAAM7B,KAAKgB,cACpBc,OAASC,IACP,IAAKA,EAAQ,CACX,M,CAEF/B,KAAKe,UAAYgB,EACjB/B,KAAKQ,WAAW,I,6BA9ClBwB,EAAA,CAFPC,EAAsB,Y,mCAOMD,EAAA,CAA5BE,K"}