{"version":3,"names":["atomicRefineToggleCss","AtomicRefineToggleStyle0","AtomicRefineToggle","this","collapseFacetsAfter","initialize","searchStatus","buildSearchStatus","bindings","engine","loadModal","modalRef","document","createElement","host","insertAdjacentElement","openButton","buttonRef","enableModal","isOpen","render","h","RefineToggleGuard","key","firstRequestExecuted","searchStatusState","firstSearchExecuted","hasError","hasItems","hasResults","RefineToggleButton","i18n","onClick","setRef","button","__decorate","InitializeBindings","BindStateToController"],"sources":["src/components/search/atomic-refine-toggle/atomic-refine-toggle.pcss?tag=atomic-refine-toggle&encapsulation=shadow","src/components/search/atomic-refine-toggle/atomic-refine-toggle.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n","import {\n  buildSearchStatus,\n  SearchStatusState,\n  SearchStatus,\n} from '@coveo/headless';\nimport {Component, h, Prop, State, Element} from '@stencil/core';\nimport {\n  InitializeBindings,\n  InitializableComponent,\n  BindStateToController,\n} from '../../../utils/initialization-utils';\nimport {RefineToggleButton} from '../../common/refine-modal/button';\nimport {RefineToggleGuard} from '../../common/refine-modal/guard';\nimport {Bindings} from '../atomic-search-interface/atomic-search-interface';\n\n/**\n * The `atomic-refine-toggle` component displays a button that opens a modal containing the facets and the sort components.\n *\n * When this component is added to the `atomic-search-interface`, an `atomic-refine-modal` component is automatically created.\n * @part button - The refine toggle button.\n */\n@Component({\n  tag: 'atomic-refine-toggle',\n  styleUrl: 'atomic-refine-toggle.pcss',\n  shadow: true,\n})\nexport class AtomicRefineToggle implements InitializableComponent {\n  @Element() public host!: HTMLElement;\n  public searchStatus!: SearchStatus;\n  private modalRef?: HTMLAtomicRefineModalElement;\n  private buttonRef?: HTMLButtonElement;\n\n  @InitializeBindings() public bindings!: Bindings;\n  @State() public error!: Error;\n  @BindStateToController('searchStatus')\n  @State()\n  private searchStatusState!: SearchStatusState;\n\n  /**\n   * The number of expanded facets inside the refine modal.\n   * Remaining facets are automatically collapsed.\n   *\n   * Using the value `0` collapses all facets.\n   */\n  @Prop({reflect: true}) public collapseFacetsAfter = 0;\n\n  public initialize() {\n    this.searchStatus = buildSearchStatus(this.bindings.engine);\n  }\n\n  private loadModal() {\n    if (this.modalRef) {\n      return;\n    }\n\n    this.modalRef = document.createElement('atomic-refine-modal');\n    this.host.insertAdjacentElement('beforebegin', this.modalRef);\n    this.modalRef.openButton = this.buttonRef;\n    this.modalRef.collapseFacetsAfter = this.collapseFacetsAfter;\n  }\n\n  private enableModal() {\n    this.modalRef && (this.modalRef.isOpen = true);\n  }\n\n  public render() {\n    return (\n      <RefineToggleGuard\n        firstRequestExecuted={this.searchStatusState.firstSearchExecuted}\n        hasError={this.searchStatusState.hasError}\n        hasItems={this.searchStatusState.hasResults}\n      >\n        <RefineToggleButton\n          i18n={this.bindings.i18n}\n          onClick={() => this.enableModal()}\n          setRef={(button) => {\n            if (!button) {\n              return;\n            }\n            this.buttonRef = button;\n            this.loadModal();\n          }}\n        />\n      </RefineToggleGuard>\n    );\n  }\n}\n"],"mappings":"uTAAA,MAAMA,EAAwB,wguCAC9B,MAAAC,EAAeD,E,iXCyBFE,EAAkB,M,yBAkBCC,KAAAC,oBAAsB,E,+EAAA,C,CAE7C,UAAAC,GACLF,KAAKG,aAAeC,EAAkBJ,KAAKK,SAASC,O,CAG9C,SAAAC,GACN,GAAIP,KAAKQ,SAAU,CACjB,M,CAGFR,KAAKQ,SAAWC,SAASC,cAAc,uBACvCV,KAAKW,KAAKC,sBAAsB,cAAeZ,KAAKQ,UACpDR,KAAKQ,SAASK,WAAab,KAAKc,UAChCd,KAAKQ,SAASP,oBAAsBD,KAAKC,mB,CAGnC,WAAAc,GACNf,KAAKQ,WAAaR,KAAKQ,SAASQ,OAAS,K,CAGpC,MAAAC,GACL,OACEC,EAACC,EAAiB,CAAAC,IAAA,2CAChBC,qBAAsBrB,KAAKsB,kBAAkBC,oBAC7CC,SAAUxB,KAAKsB,kBAAkBE,SACjCC,SAAUzB,KAAKsB,kBAAkBI,YAEjCR,EAACS,EAAkB,CAAAP,IAAA,2CACjBQ,KAAM5B,KAAKK,SAASuB,KACpBC,QAAS,IAAM7B,KAAKe,cACpBe,OAASC,IACP,IAAKA,EAAQ,CACX,M,CAEF/B,KAAKc,UAAYiB,EACjB/B,KAAKO,WAAW,I,6BAhDGyB,EAAA,CAA5BC,K,+BAIOD,EAAA,CAFPE,EAAsB,iB"}