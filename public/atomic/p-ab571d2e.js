function e(e){let t;return function(...n){return e&&(t=e.apply(this,n),e=()=>{}),t}}function t(e){return e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase()}function n(e,t=5){return e+Math.random().toString(36).substr(2,2+t)}function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function i(e){return!!e&&!!e[H]}function o(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[Y]||!!e.constructor[Y]||d(e)||f(e))}function u(e,t,n){void 0===n&&(n=!1),0===s(e)?(n?Object.keys:z)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function s(e){var t=e[H];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:d(e)?2:f(e)?3:0}function a(e,t){return 2===s(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c(e,t,n){var r=s(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function l(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e){return _&&e instanceof Map}function f(e){return N&&e instanceof Set}function h(e){return e.o||e.t}function v(e){if(Array.isArray(e))return e.slice();var t=U(e);delete t[H];for(var n=z(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function m(e,t){p(e)||i(e)||!o(e)||(s(e)>1&&(e.set=e.add=e.clear=e.delete=y),Object.freeze(e),t&&u(e,(function(e,t){return m(t,!0)}),!0))}function y(){r(2)}function p(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function g(e){var t=B[e];return t||r(19,e),t}function b(){return F}function w(e,t){t&&(g("Patches"),e.u=[],e.s=[],e.v=t)}function O(e){S(e),e.p.forEach(q),e.p=null}function S(e){e===F&&(F=e.l)}function j(e){return F={p:[],l:F,h:e,m:!0,_:0}}function q(e){var t=e[H];0===t.i||1===t.i?t.j():t.g=!0}function I(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.O||g("ES5").S(t,e,i),i?(n[H].P&&(O(t),r(4)),o(e)&&(e=A(t,e),t.l||C(t,e)),t.u&&g("Patches").M(n[H],e,t.u,t.s)):e=A(t,n,[]),O(t),t.u&&t.v(t.u,t.s),e!==L?e:void 0}function A(e,t,n){if(p(t))return t;var r=t[H];if(!r)return u(t,(function(i,o){return x(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return C(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=v(r.k):r.o;u(i,(function(t,o){return x(e,r,i,t,o,n)})),C(e,i,!1),n&&e.u&&g("Patches").R(r,n,e.u,e.s)}return r.o}function x(e,t,n,r,u,s){if(i(u)){var l=A(e,u,s&&t&&3!==t.i&&!a(t.D,r)?s.concat(r):void 0);if(c(n,r,l),!i(l))return;e.m=!1}if(o(u)&&!p(u)){if(!e.h.N&&e._<1)return;A(e,u),t&&t.A.l||C(e,u)}}function C(e,t,n){void 0===n&&(n=!1),e.h.N&&e.m&&m(t,n)}function M(e,t){var n=e[H];return(n?h(n):e)[t]}function R(e){e.P||(e.P=!0,e.l&&R(e.l))}function E(e){e.o||(e.o=v(e.t))}function T(e,t,n){var r=d(t)?g("MapSet").T(t,n):f(t)?g("MapSet").F(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:b(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=Q;n&&(i=[r],o=J);var u=Proxy.revocable(i,o),s=u.revoke,a=u.proxy;return r.k=a,r.j=s,a}(t,n):g("ES5").J(t,n);return(n?n.A:b()).p.push(r),r}function k(e){return i(e)||r(22,e),function e(t){if(!o(t))return t;var n,r=t[H],i=s(t);if(r){if(!r.P&&(r.i<4||!g("ES5").K(r)))return r.t;r.I=!0,n=P(t,i),r.I=!1}else n=P(t,i);return u(n,(function(t,i){r&&function(e,t){return 2===s(e)?e.get(t):e[t]}(r.t,t)===i||c(n,t,e(i))})),3===i?new Set(n):n}(e)}function P(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return v(e)}var V,F,D="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),_="undefined"!=typeof Map,N="undefined"!=typeof Set,$="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,L=D?Symbol("immer-nothing"):((V={})["immer-nothing"]=!0,V),Y=D?Symbol("immer-draftable"):"__$immer_draftable",H=D?Symbol("immer-state"):"__$immer_state",z="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,U=Object.getOwnPropertyDescriptors||function(e){var t={};return z(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},B={},Q={get:function(e,t){if(t===H)return e;var n=h(e);if(!a(n,t))return function(e,t,n){if(n in t)for(var r=Object.getPrototypeOf(t);r;){var i,o=Object.getOwnPropertyDescriptor(r,n);if(o)return"value"in o?o.value:null===(i=o.get)||void 0===i?void 0:i.call(e.k);r=Object.getPrototypeOf(r)}}(e,n,t);var r=n[t];return e.I||!o(r)?r:r===M(e.t,t)?(E(e),e.o[t]=T(e.A.h,r,e)):r},has:function(e,t){return t in h(e)},ownKeys:function(e){return Reflect.ownKeys(h(e))},set:function(e,t,n){if(e.D[t]=!0,!e.P){if(l(n,M(h(e),t))&&void 0!==n)return!0;E(e),R(e)}return e.o[t]=n,!0},deleteProperty:function(e,t){return void 0!==M(e.t,t)||t in e.t?(e.D[t]=!1,E(e),R(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=h(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},J={};u(Q,(function(e,t){J[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),J.deleteProperty=function(e,t){return Q.deleteProperty.call(this,e[0],t)},J.set=function(e,t,n){return Q.set.call(this,e[0],t,n,e[0])};var W=new(function(){function e(e){this.O=$,this.N=!1,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,n){if("function"==typeof e&&"function"!=typeof t){var i=t;t=e;var u=this;return function(e){var n=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return u.produce(e,(function(e){var r;return(r=t).call.apply(r,[n,e].concat(o))}))}}var s;if("function"!=typeof t&&r(6),void 0!==n&&"function"!=typeof n&&r(7),o(e)){var a=j(this),c=T(this,e,void 0),l=!0;try{s=t(c),l=!1}finally{l?O(a):S(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return w(a,n),I(e,a)}),(function(e){throw O(a),e})):(w(a,n),I(s,a))}if(!e||"object"!=typeof e){if((s=t(e))===L)return;return void 0===s&&(s=e),this.N&&m(s,!0),s}r(21,e)},t.produceWithPatches=function(e,t){var n,r,i=this;return"function"==typeof e?function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(r))}))}:[this.produce(e,t,(function(e,t){n=e,r=t})),n,r]},t.createDraft=function(e){o(e)||r(8),i(e)&&(e=k(e));var t=j(this),n=T(this,e,void 0);return n[H].C=!0,S(t),n},t.finishDraft=function(e,t){var n=(e&&e[H]).A;return w(n,t),I(void 0,n)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!$&&r(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var o=g("Patches").$;return i(e)?o(e,t):this.produce(e,(function(e){return o(e,t.slice(n+1))}))},e}()),Z=W.produce;W.produceWithPatches.bind(W),W.setAutoFreeze.bind(W),W.setUseProxies.bind(W),W.applyPatches.bind(W),W.createDraft.bind(W),W.finishDraft.bind(W);var K=function(){var e,t=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof t?t.observable?e=t.observable:(e=t("observable"),t.observable=e):e="@@observable",e}(),G=function(){return Math.random().toString(36).substring(7).split("").join(".")},X={INIT:"@@redux/INIT"+G(),REPLACE:"@@redux/REPLACE"+G(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+G()}};function ee(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function te(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(te)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,u=[],s=u,a=!1;function c(){s===u&&(s=u.slice())}function l(){if(a)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(a)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return c(),s.push(e),function(){if(t){if(a)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,c();var n=s.indexOf(e);s.splice(n,1),u=null}}}function f(e){if(!ee(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(a)throw new Error("Reducers may not dispatch actions.");try{a=!0,o=i(o,e)}finally{a=!1}for(var t=u=s,n=0;n<t.length;n++)(0,t[n])();return e}function h(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:X.REPLACE})}function v(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[K]=function(){return this},e}return f({type:X.INIT}),(r={dispatch:f,subscribe:d,getState:l,replaceReducer:h})[K]=v,r}function ne(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function re(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];"function"==typeof e[i]&&(n[i]=e[i])}var o,u=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:X.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:X.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+X.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,i={},s=0;s<u.length;s++){var a=u[s],c=e[a],l=(0,n[a])(c,t);if(void 0===l){var d=ne(a,t);throw new Error(d)}i[a]=l,r=r||l!==c}return(r=r||u.length!==Object.keys(e).length)?i:e}}function ie(e,t){return function(){return t(e.apply(this,arguments))}}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(n,!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return se({},n,{dispatch:r=ae.apply(void 0,o)(n.dispatch)})}}}var le=Object.freeze({__proto__:null,__DO_NOT_USE__ActionTypes:X,applyMiddleware:ce,bindActionCreators:function(e,t){if("function"==typeof e)return ie(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in e){var i=e[r];"function"==typeof i&&(n[r]=ie(i,t))}return n},combineReducers:re,compose:ae,createStore:te});function de(e,t){return e===t}function fe(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}function he(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}var ve=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=0,u=r.pop(),s=he(r),a=e.apply(void 0,[function(){return o++,u.apply(null,arguments)}].concat(n)),c=e((function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return a.apply(null,e)}));return c.resultFunc=u,c.dependencies=s,c.recomputations=function(){return o},c.resetRecomputations=function(){return o=0},c}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:de,n=null,r=null;return function(){return fe(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}));function me(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,r,e):t(i)}}}}var ye=me();function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Oe(e,t,n){return(Oe=we()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&be(i,n.prototype),i}).apply(null,arguments)}function Se(e){var t="function"==typeof Map?new Map:void 0;return(Se=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Oe(e,arguments,ge(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),be(n,e)})(e)}ye.withExtraArgument=me;var je="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?ae:ae.apply(null,arguments)},qe=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.concat=function(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Oe(r,(t=e.prototype.concat).call.apply(t,[this].concat(i)))},i.prepend=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?Oe(r,t[0].concat(this)):Oe(r,t.concat(this))},r}(Se(Array));function Ie(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,r=new qe;return n&&(function(e){return"boolean"==typeof e}(n)?r.push(ye):r.push(ye.withExtraArgument(n.extraArgument))),r}function Ae(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return pe({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function xe(e,t,n,r){void 0===n&&(n=[]);var u="function"==typeof t?function(e){var t,n={},r=[],i={addCase:function(e,t){var r="string"==typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,i},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[n,r,t]}(t):[t,n,r],s=u[0],a=u[1],c=u[2];return function(t,n){void 0===t&&(t=e);var r=[s[n.type]].concat(a.filter((function(e){return(0,e.matcher)(n)})).map((function(e){return e.reducer})));return 0===r.filter((function(e){return!!e})).length&&(r=[c]),r.reduce((function(e,t){if(t){if(i(e)){var r=t(e,n);return void 0===r?e:r}if(o(e))return Z(e,(function(e){return t(e,n)}));var u=t(e,n);if(void 0===u)throw Error("A case reducer on a non-draftable value must not return undefined");return u}return e}),t)}}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var Ce=["name","message","stack","code"],Me=function(e){this.value=e},Re=function(e){if("object"==typeof e&&null!==e){var t={},n=Ce,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}"string"==typeof e[o]&&(t[o]=e[o])}return t}return{message:String(e)}};function Ee(e,t,n){var r=Ae(e+"/fulfilled",(function(e,t,n){return{payload:e,meta:{arg:n,requestId:t}}})),i=Ae(e+"/pending",(function(e,t){return{payload:void 0,meta:{arg:t,requestId:e}}})),o=Ae(e+"/rejected",(function(e,t,n,r){var i=!!e&&"AbortError"===e.name,o=!!e&&"ConditionError"===e.name;return{payload:r,error:Re(e||"Rejected"),meta:{arg:n,requestId:t,aborted:i,condition:o}}})),u="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,a,c){var l,d=function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),f=new u,h=new Promise((function(e,t){return f.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),v=!1,m=function(){try{var u,l=function(e){return m?e:(n&&!n.dispatchConditionRejection&&o.match(u)&&u.meta.condition||s(u),u)},m=!1,y=function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){if(n&&n.condition&&!1===n.condition(e,{getState:a,extra:c}))throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return v=!0,s(i(d,e)),Promise.resolve(Promise.race([h,Promise.resolve(t(e,{dispatch:s,getState:a,extra:c,requestId:d,signal:f.signal,rejectWithValue:function(e){return new Me(e)}})).then((function(t){return t instanceof Me?o(null,d,e,t.value):r(t,d,e)}))])).then((function(e){u=e}))}),(function(t){u=o(t,d,e)}));return Promise.resolve(y&&y.then?y.then(l):l(y))}catch(e){return Promise.reject(e)}}();return Object.assign(m,{abort:function(e){v&&(l=e,f.abort())}})}}),{pending:i,rejected:o,fulfilled:r,typePrefix:e})}!function(){function e(e,t){var n=o[e];return n?n.enumerable=t:o[e]=n={configurable:!0,enumerable:t,get:function(){return Q.get(this[H],e)},set:function(t){Q.set(this[H],e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][H];if(!i.P)switch(i.i){case 5:r(i)&&R(i);break;case 4:n(i)&&R(i)}}}function n(e){for(var t=e.t,n=e.k,r=z(n),i=r.length-1;i>=0;i--){var o=r[i];if(o!==H){var u=t[o];if(void 0===u&&!a(t,o))return!0;var s=n[o],c=s&&s[H];if(c?c.t!==u:!l(s,u))return!0}}var d=!!t[H];return r.length!==z(t).length+(d?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var o={};!function(e,t){B.ES5=t}(0,{J:function(t,n){var r=Array.isArray(t),i=function(t,n){var r=U(n);t&&delete r.length,delete r[H];for(var i=z(r),o=0;o<i.length;o++){var u=i[o];r[u]=e(u,t||!!r[u].enumerable)}if(t){var s=Array(n.length);return Object.defineProperties(s,r),s}return Object.create(Object.getPrototypeOf(n),r)}(r,t),o={i:r?5:4,A:n?n.A:b(),P:!1,I:!1,D:{},l:n,t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,H,{value:o,writable:!0}),i},S:function(e,n,o){o?i(n)&&n[H].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[H];if(n){var i=n.t,o=n.k,s=n.D,c=n.i;if(4===c)u(o,(function(t){t!==H&&(void 0!==i[t]||a(i,t)?s[t]||e(o[t]):(s[t]=!0,R(n)))})),u(i,(function(e){void 0!==o[e]||a(o,e)||(s[e]=!1,R(n))}));else if(5===c){if(r(n)&&(R(n),s.length=!0),o.length<i.length)for(var l=o.length;l<i.length;l++)s[l]=!1;else for(var d=i.length;d<o.length;d++)s[d]=!0;for(var f=Math.min(o.length,i.length),h=0;h<f;h++)void 0===s[h]&&e(o[h])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}();class Te extends Error{constructor(e){super(e),this.name="SchemaValidationError"}}class ke{constructor(e){this.definition=e}validate(e={},t=""){const n={...this.default,...e},r=[];for(const e in this.definition){const t=this.definition[e].validate(n[e]);t&&r.push(`${e}: ${t}`)}if(r.length)throw function(e,t){const n=`\n  The following properties are invalid:\n\n    ${e.join("\n\t")}\n  \n  ${t}\n  `;return new Te(n)}(r,t);return n}get default(){const e={};for(const t in this.definition){const n=this.definition[t].default;void 0!==n&&(e[t]=n)}return e}}class Pe{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&Fe(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return!0===this.baseConfig.required}}function Ve(e){return void 0===e}function Fe(e){return Ve(e)||function(e){return null===e}(e)}class De{constructor(e={}){this.config=e,this.value=new Pe(e)}validate(e){return this.value.validate(e)||(function(e){return Ve(e)||_e(e)}(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}}function _e(e){return"number"==typeof e}class Ne{constructor(e={}){this.value=new Pe(e)}validate(e){return this.value.validate(e)||(function(e){return Ve(e)||$e(e)}(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}}function $e(e){return"boolean"==typeof e}const Le=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;class Ye{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new Pe(this.config)}validate(e){const{emptyAllowed:t,url:n,regex:r,constrainTo:i}=this.config;return this.value.validate(e)||(Ve(e)?null:He(e)?t||e.length?n&&!Le.test(e)?"value is not a valid URL.":r&&!r.test(e)?"value did not match provided regex "+r:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is an empty string.":"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}}function He(e){return"[object String]"===Object.prototype.toString.call(e)}class ze{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(Ve(e))return this.config.options.required?"value is required and is currently undefined":null;if(!Ue(e))return"value is not an object";for(const[t,n]of Object.entries(this.config.values))if(n.required&&Fe(e[t]))return"value does not contain "+t;let t="";for(const[n,r]of Object.entries(this.config.values)){const i=r.validate(e[n]);null!==i&&(t+=" "+i)}return""===t?null:t}get default(){}get required(){return!!this.config.options.required}}function Ue(e){return void 0!==e&&"object"==typeof e}class Be{constructor(e={}){this.config=e,this.value=new Pe(this.config)}validate(e){if(!Fe(e)&&!Array.isArray(e))return"value is not an array";const t=this.value.validate(e);if(null!==t)return t;if(Fe(e))return null;if(void 0!==this.config.max&&e.length>this.config.max)return"value contains more than "+this.config.max;if(void 0!==this.config.min&&e.length<this.config.min)return"value contains less than "+this.config.min;if(void 0!==this.config.each){let t="";return e.forEach((n=>{this.config.each.required&&Fe(n)&&(t="value is null or undefined: "+e.join(","));const r=this.validatePrimitiveValue(n,this.config.each);null!==r&&(t+=" "+r)})),""===t?null:t}return null}validatePrimitiveValue(e,t){return $e(e)||He(e)||_e(e)||Ue(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}}function Qe(e){return Array.isArray(e)}class Je{constructor(e){this.config=e,this.value=new Pe(e)}validate(e){const t=this.value.validate(e);return null!==t?t:Ve(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}}const We=new Ye({required:!0,emptyAllowed:!1}),Ze=new Ye({required:!0,emptyAllowed:!0}),Ke=({message:e,name:t,stack:n})=>({message:e,name:t,stack:n}),Ge=(e,t)=>"required"in t?{payload:new ke({value:t}).validate({value:e}).value}:{payload:new ke(t).validate(e)},Xe=(e,t)=>{try{return Ge(e,t)}catch(t){return{payload:e,error:Ke(t)}}},et=(e,t,n,r)=>nt(e,t,n,"Check the initialState of "+r,"Controller initialization error"),tt=(e,t,n,r)=>nt(e,t,n,"Check the options of "+r,"Controller initialization error"),nt=(e,t,n,r,i)=>{try{return t.validate(n,r)}catch(t){throw e.logger.error(t,i),t}},rt=()=>new Ye({emptyAllowed:!1,required:!1}),it=()=>new Ye({emptyAllowed:!1,required:!0}),ot=Ae("configuration/updateBasicConfiguration",(e=>Xe(e,{accessToken:new Ye({emptyAllowed:!1}),organizationId:new Ye({emptyAllowed:!1}),platformUrl:new Ye({url:!0,emptyAllowed:!1})}))),ut=Ae("configuration/updateSearchConfiguration",(e=>Xe(e,{apiBaseUrl:new Ye({url:!0,emptyAllowed:!1}),pipeline:new Ye({emptyAllowed:!1}),searchHub:new Ye({emptyAllowed:!1})}))),st=Ae("configuration/updateAnalyticsConfiguration",(e=>Xe(e,{enabled:new Ne({default:!0}),originLevel2:rt(),originLevel3:rt(),apiBaseUrl:new Ye({url:!0,emptyAllowed:!1}),runtimeEnvironment:new Pe}))),at=Ee("configuration/renewAccessToken",(async e=>await e())),ct=Ae("configuration/analytics/disable"),lt=Ae("configuration/analytics/enable"),dt=Ae("configuration/analytics/originlevel2",(e=>Xe(e,{originLevel2:it()}))),ft=Ae("configuration/analytics/originlevel3",(e=>Xe(e,{originLevel3:it()})));var ht=fetch,vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function mt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yt(e,t,n){return e(n={path:t,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}var pt=yt((function(e,t){var n=vt&&vt.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};t.getSanitizedOptions=function(e){var t=n(n({},r),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}}));mt(pt);var gt=yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fullJitter=function(e){var t=Math.random()*e;return Math.round(t)}}));mt(gt);var bt=yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.noJitter=function(e){return e}}));mt(bt);var wt=yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.JitterFactory=function(e){switch(e.jitter){case"full":return gt.fullJitter;case"none":default:return bt.noJitter}}}));mt(wt);var Ot=yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return wt.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay*Math.pow(this.options.timeMultiple,this.numOfDelayedAttempts);return Math.min(e,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();t.Delay=n}));mt(Ot);var St=yt((function(e,t){var n,r=vt&&vt.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=vt&&vt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},o=vt&&vt.__generator||function(e,t){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(){return i(this,void 0,void 0,(function(){return o(this,(function(){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(Ot.Delay);t.SkipFirstDelay=u}));mt(St);var jt=yt((function(e,t){var n,r=vt&&vt.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(Ot.Delay);t.AlwaysDelay=i}));mt(jt);var qt=yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DelayFactory=function(e,t){var n=function(e){return e.delayFirstAttempt?new jt.AlwaysDelay(e):new St.SkipFirstDelay(e)}(e);return n.setAttemptNumber(t),n}}));mt(qt);var It=yt((function(e,t){var n=vt&&vt.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))},r=vt&&vt.__generator||function(e,t){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.backOff=function(e,t){return void 0===t&&(t={}),n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return n=pt.getSanitizedOptions(t),[4,new i(e,n).execute()];case 1:return[2,r.sent()]}}))}))};var i=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return n(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,qt.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}()}));mt(It);var At=It.backOff;function xt(e){return 429===e}const Ct=e=>e;class Mt{static async call(e){const t={...e,...await e.preprocessRequest(e)},n={url:t.url,method:t.method,headers:{"Content-Type":t.contentType,Authorization:"Bearer "+t.accessToken,...t.headers},body:t.requestParams};t.logger.info(n,"Platform request");const r=async()=>{const n=await ht(t.url,{method:t.method,headers:{"Content-Type":t.contentType,Authorization:"Bearer "+t.accessToken,...t.headers},body:JSON.stringify(t.requestParams),signal:e.signal});if(xt(n.status))throw n;return n};try{const i=await At(r,{retry:t=>{const n=t&&xt(t.status);return n&&e.logger.info("Platform retrying request"),n}});if(419===i.status){t.logger.info("Platform renewing token");const e=await t.renewAccessToken();if(""!==e)return Mt.call({...t,accessToken:e})}const o=await i.json();return e.logger.info({response:i,body:o,requestInfo:n},"Platform response"),{response:i,body:o}}catch(e){if(e.body)return{response:e,body:await e.json()};throw e}}}function Rt(e){return`https://platform${e&&e.environment&&"prod"!==e.environment?e.environment:""}${e&&e.region&&"us-east-1"!==e.region?"-"+e.region:""}.cloud.coveo.com`}const Et=()=>({organizationId:"",accessToken:"",platformUrl:Rt(),search:{apiBaseUrl:Rt()+"/rest/search/v2"},analytics:{enabled:!0,apiBaseUrl:Rt()+"/rest/ua",originLevel2:"default",originLevel3:"default"}}),Tt=xe(Et(),(e=>e.addCase(ot,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=t.payload.platformUrl+"/rest/search/v2",e.analytics.apiBaseUrl=t.payload.platformUrl+"/rest/ua")})).addCase(ut,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl)})).addCase(st,((e,t)=>{void 0!==t.payload.enabled&&(e.analytics.enabled=t.payload.enabled),void 0!==t.payload.originLevel2&&(e.analytics.originLevel2=t.payload.originLevel2),void 0!==t.payload.originLevel3&&(e.analytics.originLevel3=t.payload.originLevel3),void 0!==t.payload.apiBaseUrl&&(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),void 0!==t.payload.runtimeEnvironment&&(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment)})).addCase(at.fulfilled,((e,t)=>{e.accessToken=t.payload})).addCase(ct,(e=>{e.analytics.enabled=!1})).addCase(lt,(e=>{e.analytics.enabled=!0})).addCase(dt,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(ft,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})))),kt=new Be({each:We,required:!0}),Pt=(e,t)=>(Xe(e,We),He(t)?Xe(t,We):Xe(t,kt),{payload:{contextKey:e,contextValue:t}}),Vt=Ae("context/set",(e=>{for(const[t,n]of Object.entries(e))Pt(t,n);return{payload:e}})),Ft=Ae("context/add",(e=>Pt(e.contextKey,e.contextValue))),Dt=Ae("context/remove",(e=>Xe(e,We))),_t="@@undoable/UNDO",Nt="@@undoable/REDO",$t=e=>({past:[],present:e,future:[]}),Lt={undo:Ae(_t),redo:Ae(Nt)},Yt=Ae("history/snapshot"),Ht=Ee("history/back",(async(e,{dispatch:t})=>{await t(Lt.undo()),await t(Ut())})),zt=Ee("history/forward",(async(e,{dispatch:t})=>{await t(Lt.redo()),await t(Ut())})),Ut=Ee("history/change",(async(e,{getState:t})=>t().history.present)),Bt=xe({contextValues:{}},(e=>{e.addCase(Vt,((e,t)=>{e.contextValues=t.payload})).addCase(Ft,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(Dt,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Ut.fulfilled,((e,t)=>{e.contextValues=t.payload.context.contextValues}))})),Qt="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;if(!Qt)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!Qt.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');var Jt=Qt.AbortController;Jt.default=Qt.AbortController;const Wt=(e,t,n,r)=>({accessToken:e.accessToken,method:t,contentType:n,url:`${e.url}${r}?${Zt(e)}`}),Zt=e=>"organizationId="+e.organizationId;class Kt{constructor(e){this.options=e,this.searchAbortController=null}async plan(e){const t=await Mt.call({...Wt(e,"POST","application/json","/plan"),requestParams:rn(e),...this.options});return function(e){return void 0!==e.body.preprocessingOutput}(t)?{success:t.body}:{error:Gt(t)}}async querySuggest(e){const t=await Mt.call({...Wt(e,"POST","application/json","/querySuggest"),requestParams:rn(e),...this.options});return function(e){return void 0!==e.body.completions}(t)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(t)).body}:{error:Gt(t)}}async search(e){this.searchAbortController&&(this.options.logger.warn("Cancelling current pending search query"),this.searchAbortController.abort()),this.searchAbortController=new Jt;const t=await Mt.call({...Wt(e,"POST","application/json",""),requestParams:rn(e),...this.options,signal:this.searchAbortController.signal});return this.searchAbortController=null,nn(t)?{success:(await this.options.postprocessSearchResponseMiddleware(t)).body}:{error:Gt(t)}}async facetSearch(e){const t=await Mt.call({...Wt(e,"POST","application/json","/facet"),requestParams:rn(e),...this.options});return(await this.options.postprocessFacetSearchResponseMiddleware(t)).body}async recommendations(e){const t=await Mt.call({...Wt(e,"POST","application/json",""),requestParams:rn(e),...this.options});return nn(t)?{success:t.body}:{error:Gt(t)}}async productRecommendations(e){const t=await Mt.call({...Wt(e,"POST","application/json",""),requestParams:rn(e),...this.options});return nn(t)?{success:t.body}:{error:Gt(t)}}}const Gt=e=>function(e){return void 0!==e.body.exception}(e)?Xt(e):function(e){return void 0!==e.body.statusCode}(e)?en(e):{message:"unknown",statusCode:0,type:"unknown"},Xt=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),en=e=>({message:e.body.message,statusCode:e.body.statusCode,type:e.body.type}),tn=e=>void 0!==e.error;function nn(e){return void 0!==e.body.results}function rn(e){const{url:t,accessToken:n,organizationId:r,...i}=e;return i}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function on(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function un(e,t,n,r){return new(n||(n=Promise))((function(i,o){function u(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}a((r=r.apply(e,t||[])).next())}))}var sn;!function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"}(sn||(sn={}));class an{constructor(e){this.opts=e}sendEvent(e,t){return un(this,void 0,void 0,(function*(){const{baseUrl:n,visitorIdProvider:r}=this.opts,i=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",o=yield fetch(`${n}/analytics/${e}${i}`,{method:"POST",headers:this.getHeaders(),mode:"cors",body:JSON.stringify(t),credentials:"include"});if(o.ok){const e=yield o.json();return e.visitorId&&r.setCurrentVisitorId(e.visitorId),e}try{o.json()}catch(e){}throw console.error(`An error has occured when sending the "${e}" event.`,o,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}shouldAppendVisitorId(e){return-1!==[sn.click,sn.custom,sn.search,sn.view].indexOf(e)}getVisitorIdParam(){return un(this,void 0,void 0,(function*(){const{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?"?visitor="+t:""}))}getHeaders(){const{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:"Bearer "+e}:{}),{"Content-Type":"application/json"})}}function cn(){return"undefined"!=typeof localStorage}function ln(){return"undefined"!=typeof navigator&&navigator.cookieEnabled}const dn=[sn.click,sn.custom,sn.search,sn.view],fn=(e,t)=>-1!==dn.indexOf(e)?Object.assign({language:document.documentElement.lang,userAgent:navigator.userAgent},t):t;class hn{static set(e,t,n){var r,i,o,u,s;n?((o=new Date).setTime(o.getTime()+n),u="; expires="+o.toGMTString()):u="",-1===(s=location.hostname).indexOf(".")?document.cookie=e+"="+t+u+"; path=/":((i=s.split(".")).shift(),r="."+i.join("."),document.cookie=e+"="+t+u+"; path=/; domain="+r,null!=hn.get(e)&&hn.get(e)==t||(r="."+s,document.cookie=e+"="+t+u+"; path=/; domain="+r))}static get(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){var i=n[r];if(0==(i=i.replace(/^\s+/,"")).indexOf(t))return i.substring(t.length,i.length)}return null}static erase(e){hn.set(e,"",-1)}}class vn{getItem(e){return hn.get(`${vn.prefix}${e}`)}removeItem(e){hn.erase(`${vn.prefix}${e}`)}setItem(e,t){hn.set(`${vn.prefix}${e}`,t)}}vn.prefix="coveo_";class mn{constructor(){this.cookieStorage=new vn}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t)}}class yn{getItem(e){return null}removeItem(e){}setItem(e,t){}}const pn="__coveo.analytics.history";class gn{constructor(e){this.store=e||(cn()?localStorage:ln()?new vn:"undefined"!=typeof sessionStorage?sessionStorage:new yn)}addElement(e){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return un(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){const e=this.getHistoryWithInternalTime();return this.stripInternalTime(e)}getHistoryAsync(){return un(this,void 0,void 0,(function*(){const e=yield this.getHistoryWithInternalTimeAsync();return this.stripInternalTime(e)}))}getHistoryWithInternalTime(){try{const e=this.store.getItem(pn);return e&&"string"==typeof e?JSON.parse(e):[]}catch(e){return[]}}getHistoryWithInternalTimeAsync(){return un(this,void 0,void 0,(function*(){try{const e=yield this.store.getItem(pn);return e?JSON.parse(e):[]}catch(e){return[]}}))}setHistory(e){try{this.store.setItem(pn,JSON.stringify(e.slice(0,20)))}catch(e){}}clear(){try{this.store.removeItem(pn)}catch(e){}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return null!=e?e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]:null}cropQueryElement(e){e.name&&"query"==e.name.toLowerCase()&&null!=e.value&&(e.value=e.value.slice(0,75))}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return e.map((e=>{const{name:t,time:n,value:r}=e;return{name:t,time:n,value:r}}))}}var bn=Object.freeze({__proto__:null,STORE_KEY:pn,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,MAX_VALUE_SIZE:75,HistoryStore:gn,default:gn});const wn=(e,t)=>un(void 0,void 0,void 0,(function*(){return e===sn.view?(yield On(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),On=e=>un(void 0,void 0,void 0,(function*(){const t=new gn,n={name:"PageView",value:e,time:JSON.stringify(new Date)};yield t.addElementAsync(n)})),Sn=e=>e?(Number(e)^jn(new Uint8Array(1))[0]%16>>Number(e)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Sn),jn=e=>{if("undefined"!=typeof crypto&&void 0!==crypto.getRandomValues)return crypto.getRandomValues(e);for(var t=0,n=0;t<e.length;t++)0==(3&t)&&(n=4294967296*Math.random()),e[t]=n>>>((3&t)<<3)&255;return e},qn=Object.keys,In={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},An=[...qn(In).map((e=>In[e]))].join("|"),xn=new RegExp(`^(${An}$)`),Cn=e=>xn.test(e),Mn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps"},Rn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr"},En=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{action:"pa",list:"pal",listSource:"pls"}),{id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),{anonymizeIp:"aip"}),{svcAction:"svc_action",svcActionData:"svc_action_data"}),Tn=qn(En).map((e=>En[e])),kn=qn(Mn).map((e=>Mn[e])),Pn=qn(Rn).map((e=>Rn[e])),Vn=[...kn,"custom"].join("|"),Fn=[...Pn,"custom"].join("|"),Dn=new RegExp(`^(pr[0-9]+)(${Vn})$`),_n=new RegExp(`^((il[0-9]+pi[0-9]+)(${Fn}))|(il[0-9]+nm)$`),Nn=new RegExp("^(pr[0-9]+)custom$"),$n=new RegExp("^(il[0-9]+pi[0-9]+)custom$"),Ln=e=>Dn.test(e),Yn=e=>_n.test(e),Hn=e=>-1!==Tn.indexOf(e),zn=e=>"custom"===e;class Un{constructor(e){this.opts=e}sendEvent(e,t){return un(this,void 0,void 0,(function*(){if(!navigator.sendBeacon)throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');const{baseUrl:n}=this.opts,r=this.encodeForEventType(e,t),i=yield this.getQueryParamsForEventType(e),o=`${n}/analytics/${e}?${i}`;console.log(`Sending beacon for "${e}" with: `,JSON.stringify(t)),navigator.sendBeacon(o,new Blob([r],{type:"application/x-www-form-urlencoded"}))}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,t):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},t))}getQueryParamsForEventType(e){return un(this,void 0,void 0,(function*(){const{token:t,visitorIdProvider:n}=this.opts,r=yield n.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?"access_token="+t:"",r?"visitorId="+r:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[sn.click,sn.custom,sn.search,sn.view].indexOf(e)}encodeForLegacyType(e,t){return`${e}Event=${encodeURIComponent(JSON.stringify(t))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter((t=>!!e[t])).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(this.encodeValue(e[t]))}`)).join("&")}encodeValue(e){return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:JSON.stringify(e)}}class Bn{sendEvent(e,t){return un(this,void 0,void 0,(function*(){return Promise.resolve()}))}}class Qn{constructor(e,t){cn()&&ln()?this.storage=new mn:cn()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new yn),this.beaconClient=new Un(e),window.addEventListener("beforeunload",(()=>t()))}}class Jn{constructor(e,t){this.storage=t||new yn,this.beaconClient=new an(e)}}class Wn{constructor(){this.storage=new yn,this.beaconClient=new Bn}}class Zn{constructor(e){if(!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[wn,fn].concat(this.options.beforeSendHooks),this.eventTypeMapping={};const t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this};this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.analyticsFetchClient=new an(t)}get defaultOptions(){return{endpoint:"https://platform.cloud.coveo.com/rest/ua",token:"",version:"v15",beforeSendHooks:[]}}initRuntime(e){return"undefined"!=typeof window&&"undefined"!=typeof document?new Qn(e,(()=>this.flushBufferWithBeacon())):("undefined"!=typeof navigator&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please install @react-native-async-storage/async-storage and instantiate \n        your analytics client as follows:\n        \n        import {ReactNativeRuntime} from 'coveo.analytics/react-native';\n        \n        const analytics = new CoveoAnalytics({\n            ...your options,\n            runtimeEnvironment: new ReactNativeRuntime();\n        })\n    "),new Jn(e))}get analyticsBeaconClient(){return this.runtime.beaconClient}get storage(){return this.runtime.storage}determineVisitorId(){return un(this,void 0,void 0,(function*(){try{return(yield this.storage.getItem("visitorId"))||Sn()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Sn()}}))}getCurrentVisitorId(){return un(this,void 0,void 0,(function*(){if(!this.visitorId){const e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return un(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(Sn()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}sendEvent(e,...t){return un(this,void 0,void 0,(function*(){const{newEventType:n=e,variableLengthArgumentsNames:r=[],addVisitorIdParameter:i=!1,usesMeasurementProtocol:o=!1}=this.eventTypeMapping[e]||{},u=yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>un(this,void 0,void 0,(function*(){return Object.assign({visitorId:i?yield this.getCurrentVisitorId():""},e)})),e=>o?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,n)=>un(this,void 0,void 0,(function*(){const r=yield t;return yield n(e,r)}))),t),t=>this.removeEmptyPayloadValues(t,e),e=>this.validateParams(e),e=>{return o?qn(t=e).reduce(((e,n)=>{const r=En[n]||n;return Object.assign(Object.assign({},e),{[r]:t[n]})}),{}):e;var t},e=>o?this.removeUnknownParameters(e):e,e=>o?this.processCustomParameters(e):e].reduce(((e,t)=>un(this,void 0,void 0,(function*(){const n=yield e;return yield t(n)}))),Promise.resolve(t));return this.bufferedRequests.push({eventType:n,payload:u,handled:!1}),yield this.deferExecution(),yield this.sendFromBufferWithFetch()}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}flushBufferWithBeacon(){for(;this.hasPendingRequests();){const{eventType:e,payload:t}=this.bufferedRequests.pop();this.analyticsBeaconClient.sendEvent(e,t)}}sendFromBufferWithFetch(){return un(this,void 0,void 0,(function*(){const e=this.bufferedRequests.shift();if(e){const{eventType:t,payload:n}=e;return this.analyticsFetchClient.sendEvent(t,n)}}))}hasPendingRequests(){return this.bufferedRequests.length>0}clear(){this.storage.removeItem("visitorId"),(new gn).clear()}sendSearchEvent(e){return un(this,void 0,void 0,(function*(){return this.sendEvent(sn.search,e)}))}sendClickEvent(e){return un(this,void 0,void 0,(function*(){return this.sendEvent(sn.click,e)}))}sendCustomEvent(e){return un(this,void 0,void 0,(function*(){return this.sendEvent(sn.custom,e)}))}sendViewEvent(e){return un(this,void 0,void 0,(function*(){return this.sendEvent(sn.view,e)}))}getVisit(){return un(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/visit"),t=yield e.json();return this.visitorId=t.visitorId,t}))}getHealth(){return un(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/monitoring/health");return yield e.json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}parseVariableArgumentsPayload(e,t){const n={};for(let r=0,i=t.length;r<i;r++){const i=t[r];if("string"==typeof i)n[e[r]]=i;else if("object"==typeof i)return Object.assign(Object.assign({},n),i)}return n}isKeyAllowedEmpty(e,t){return-1!==({[sn.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((n=>{return this.isKeyAllowedEmpty(t,n)||null!=(r=e[n])&&""!==r;var r})).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[Ln,Cn,Yn,Hn,zn].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{})}processCustomParameters(e){const{custom:t}=e,n=on(e,["custom"]),r=this.lowercaseKeys(t),i=qn(o=n).reduce(((e,t)=>{const n=Nn.exec(t)||$n.exec(t);if(n){const r=n[1];return Object.assign(Object.assign({},e),((e,t)=>qn(t).reduce(((n,r)=>Object.assign(Object.assign({},n),{[`${e}${r}`]:t[r]})),{}))(r,o[t]))}return Object.assign(Object.assign({},e),{[t]:o[t]})}),{});var o;return Object.assign(Object.assign({},r),i)}lowercaseKeys(e){return Object.keys(e||{}).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n.toLowerCase()]:e[n]})),{})}validateParams(e){const{anonymizeIp:t}=e,n=on(e,["anonymizeIp"]);return void 0!==t&&-1==["0","false","undefined","null","{}","[]",""].indexOf((""+t).toLowerCase())&&(n.anonymizeIp=1),n}ensureAnonymousUserWhenUsingApiKey(e){const{userId:t}=e,n=on(e,["userId"]);return(null==(r=this.options.token)?void 0:r.startsWith("xx"))&&!t?(n.userId="anonymous",n):e;var r}get baseUrl(){const{version:e,endpoint:t}=this.options,n=-1!==t.indexOf(".cloud.coveo.com");return`${t}${n?"":"/rest"}/${e}`}}var Kn;!function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad"}(Kn||(Kn={}));const Gn={[Kn.triggerNotify]:"queryPipelineTriggers",[Kn.triggerExecute]:"queryPipelineTriggers",[Kn.triggerQuery]:"queryPipelineTriggers",[Kn.triggerRedirect]:"queryPipelineTriggers",[Kn.queryError]:"errors",[Kn.queryErrorBack]:"errors",[Kn.queryErrorClear]:"errors",[Kn.queryErrorRetry]:"errors",[Kn.pagerNext]:"getMoreResults",[Kn.pagerPrevious]:"getMoreResults",[Kn.pagerNumber]:"getMoreResults",[Kn.pagerResize]:"getMoreResults",[Kn.pagerScrolling]:"getMoreResults",[Kn.facetSearch]:"facet",[Kn.facetShowLess]:"facet",[Kn.facetShowMore]:"facet",[Kn.recommendation]:"recommendation"};class Xn{constructor(){this.runtime=new Wn,this.currentVisitorId=""}sendEvent(){return Promise.resolve()}sendSearchEvent(){return Promise.resolve()}sendClickEvent(){return Promise.resolve()}sendCustomEvent(){return Promise.resolve()}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}addEventTypeMapping(){}}function er(e){const t=e.join(";");return t.length<=256?t:er(e.slice(1))}const tr=e=>er(function(e){let t="";return e.filter((e=>{const n=e!==t;return t=e,n}))}(function(e){return e.map((e=>e.replace(/;/g,"")))}(e)));function nr(e){const t="string"==typeof e.partialQueries?e.partialQueries:tr(e.partialQueries),n="string"==typeof e.suggestions?e.suggestions:tr(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:n})}class rr{constructor(e,t){this.opts=e,this.provider=t,this.coveoAnalyticsClient=!1===e.enableAnalytics?new Xn:new Zn(e)}disable(){this.coveoAnalyticsClient instanceof Zn&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Xn}enable(){this.coveoAnalyticsClient=new Zn(this.opts)}logInterfaceLoad(){return this.logSearchEvent(Kn.interfaceLoad)}logRecommendationInterfaceLoad(){return this.logSearchEvent(Kn.recommendationInterfaceLoad)}logRecommendation(){return this.logCustomEvent(Kn.recommendation)}logFetchMoreResults(){return this.logCustomEvent(Kn.pagerScrolling,{type:"getMoreResults"})}logInterfaceChange(e){return this.logSearchEvent(Kn.interfaceChange,e)}logDidYouMeanAutomatic(){return this.logSearchEvent(Kn.didyoumeanAutomatic)}logDidYouMeanClick(){return this.logSearchEvent(Kn.didyoumeanClick)}logResultsSort(e){return this.logSearchEvent(Kn.resultsSort,e)}logSearchboxSubmit(){return this.logSearchEvent(Kn.searchboxSubmit)}logSearchboxClear(){return this.logSearchEvent(Kn.searchboxClear)}logSearchboxAsYouType(){return this.logSearchEvent(Kn.searchboxAsYouType)}logBreadcrumbFacet(e,t){return this.logFacetSearchEvent(Kn.breadcrumbFacet,e,t)}logBreadcrumbResetAll(){return this.logSearchEvent(Kn.breadcrumbResetAll)}logDocumentQuickview(e,t){return this.logClickEvent(Kn.documentQuickview,e,t)}logDocumentOpen(e,t){return this.logClickEvent(Kn.documentOpen,e,t)}logOmniboxAnalytics(e){return this.logSearchEvent(Kn.omniboxAnalytics,nr(e))}logOmniboxFromLink(e){return this.logSearchEvent(Kn.omniboxFromLink,nr(e))}logTriggerNotify(e){return this.logCustomEvent(Kn.triggerNotify,e)}logTriggerExecute(e){return this.logCustomEvent(Kn.triggerExecute,e)}logTriggerQuery(){const e={query:this.provider.getSearchEventRequestPayload().queryText};return this.logCustomEvent(Kn.triggerQuery,e)}logTriggerRedirect(e){const t=Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText});return this.logCustomEvent(Kn.triggerRedirect,t)}logPagerResize(e){return this.logCustomEvent(Kn.pagerResize,e)}logPagerNumber(e){return this.logCustomEvent(Kn.pagerNumber,e)}logPagerNext(e){return this.logCustomEvent(Kn.pagerNext,e)}logPagerPrevious(e){return this.logCustomEvent(Kn.pagerPrevious,e)}logPagerScrolling(){return this.logCustomEvent(Kn.pagerScrolling)}logFacetClearAll(e,t){return this.logFacetSearchEvent(Kn.facetClearAll,e,t)}logFacetSearch(e,t){return this.logFacetSearchEvent(Kn.facetSearch,e,t)}logFacetSelect(e,t){return this.logFacetSearchEvent(Kn.facetSelect,e,t)}logFacetDeselect(e,t){return this.logFacetSearchEvent(Kn.facetDeselect,e,t)}logFacetExclude(e,t){return this.logFacetSearchEvent(Kn.facetExclude,e,t)}logFacetUnexclude(e,t){return this.logFacetSearchEvent(Kn.facetUnexclude,e,t)}logFacetSelectAll(e,t){return this.logFacetSearchEvent(Kn.facetSelectAll,e,t)}logFacetUpdateSort(e,t){return this.logFacetSearchEvent(Kn.facetUpdateSort,e,t)}logFacetShowMore(e){return this.logCustomEvent(Kn.facetShowMore,e)}logFacetShowLess(e){return this.logCustomEvent(Kn.facetShowLess,e)}logQueryError(e){return this.logCustomEvent(Kn.queryError,e)}logQueryErrorBack(){return un(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Kn.queryErrorBack),this.logSearchEvent(Kn.queryErrorBack)}))}logQueryErrorRetry(){return un(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Kn.queryErrorRetry),this.logSearchEvent(Kn.queryErrorRetry)}))}logQueryErrorClear(){return un(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Kn.queryErrorClear),this.logSearchEvent(Kn.queryErrorClear)}))}logCustomEvent(e,t){const n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),r=Object.assign(Object.assign({},this.getOrigins()),{eventType:Gn[e],eventValue:e,lastSearchQueryUid:this.provider.getSearchUID(),customData:n});return this.coveoAnalyticsClient.sendCustomEvent(r)}logCustomEventWithType(e,t,n){const r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),i=Object.assign(Object.assign({},this.getOrigins()),{eventType:t,eventValue:e,lastSearchQueryUid:this.provider.getSearchUID(),customData:r});return this.coveoAnalyticsClient.sendCustomEvent(i)}logSearchEvent(e,t){return this.coveoAnalyticsClient.sendSearchEvent(this.getBaseSearchEventRequest(e,t))}logClickEvent(e,t,n,r){const i=Object.assign(Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),r),o=Object.assign(Object.assign(Object.assign({},t),this.getOrigins()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e,customData:i});return this.coveoAnalyticsClient.sendClickEvent(o)}logFacetSearchEvent(e,t,n){const r=Object.assign(Object.assign({},this.getBaseSearchEventRequest(e,t)),{facetState:n});return this.coveoAnalyticsClient.sendSearchEvent(r)}getBaseSearchEventRequest(e,t){const n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t);return Object.assign(Object.assign(Object.assign({},this.provider.getSearchEventRequestPayload()),this.getOrigins()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),customData:n,actionCause:e})}getOrigins(){return{originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}}class ir{constructor(e){this.state=e}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults,getBaseMetadata:this.getBaseMetadata()}}getBaseMetadata(){const{context:e}=this.state,t=(null==e?void 0:e.contextValues)||{},n={};for(const[e,r]of Object.entries(t))n["context_"+e]=r;return n}getSearchUID(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.response.searchUid)||""}getPipeline(){return this.state.pipeline||"default"}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2||"default"}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}mapResultsToAnalyticsDocument(){var e;return null===(e=this.state.search)||void 0===e?void 0:e.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get queryText(){var e;return(null===(e=this.state.query)||void 0===e?void 0:e.q)||""}get responseTime(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.duration)||0}get numberOfResults(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.response.results.length)||[].length}}const or=()=>new Zn({}).currentVisitorId,ur=new bn.HistoryStore;class sr{constructor(e){this.state=e,this.initialState={id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0}}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getBaseMetadata(){var e;return{recommendation:(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.id)||this.initialState.id}}getSearchUID(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.searchUid)||this.initialState.searchUid}getPipeline(){return""}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2||"default"}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}mapResultsToAnalyticsDocument(){return[]}get responseTime(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.recommendations.length)||this.initialState.recommendations.length}}var ar;!function(e){e[e.Search=0]="Search",e[e.Custom=1]="Custom",e[e.Click=2]="Click"}(ar||(ar={}));const cr=(e,t,n,r=(e=>new ir(e)))=>Ee(e,(async(e,{getState:i,extra:{analyticsClientMiddleware:o,logger:u}})=>{const s=(e=>e())(i),a=(({logger:e,state:t,analyticsClientMiddleware:n=((e,t)=>t),provider:r=new ir(t)})=>{const i=t.configuration.accessToken,o=t.configuration.analytics.apiBaseUrl,u=new rr({token:i,endpoint:o,runtimeEnvironment:t.configuration.analytics.runtimeEnvironment,beforeSendHooks:[n,(t,n)=>(e.info({...n,type:t,endpoint:o,token:i},"Analytics request"),n)]},r);return!1===t.configuration.analytics.enabled&&u.disable(),u})({state:s,logger:u,analyticsClientMiddleware:o,provider:r(s)}),c=await n(a,s);return u.info({client:a.coveoAnalyticsClient,response:c},"Analytics response"),{analyticsType:t}})),lr=(e,t)=>{var n;const r=(null===(n=t.search)||void 0===n?void 0:n.response.results.findIndex((({uniqueId:t})=>e.uniqueId===t)))||0;return{collectionName:e.raw.collection||"default",documentAuthor:e.raw.author,documentPosition:r+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:e.raw.source,queryPipeline:t.pipeline||"default"}},dr=e=>({contentIDKey:"@permanentid",contentIDValue:e.raw.permanentid}),fr=new Ye({required:!0,emptyAllowed:!1}),hr={collection:new Ye,author:new Ye,urihash:new Ye,source:new Ye,permanentid:new Ye},vr={uniqueId:fr,raw:new ze({values:hr}),title:fr,uri:fr,clickUri:fr,rankingModifier:new Ye({required:!1,emptyAllowed:!0})},mr=e=>new ke(vr).validate(function(e){return Object.assign({},...Object.keys(vr).map((t=>({[t]:e[t]}))),{raw:(t=e.raw,Object.assign({},...Object.keys(hr).map((e=>({[e]:t[e]})))))});var t}(e)),yr=cr("analytics/productrecommendations/load",ar.Search,(e=>e.logRecommendationInterfaceLoad()),(e=>new sr(e))),pr=Ae("productrecommendations/setId",(e=>Xe(e,{id:We}))),gr=Ae("productrecommendations/setSku",(e=>Xe(e,{skus:new Be({required:!0,min:1,each:new Ye({emptyAllowed:!1})})}))),br=Ae("productrecommendations/setBrand",(e=>Xe(e,{brand:new Ye({required:!0,emptyAllowed:!0})}))),wr=Ae("productrecommendations/setCategory",(e=>Xe(e,{category:new Ye({required:!0,emptyAllowed:!0})}))),Or=Ae("productrecommendations/setMaxNumberOfRecommendations",(e=>Xe(e,{number:new De({required:!0,max:50,min:1})}))),Sr=Ee("productrecommendations/get",(async(e,{getState:t,rejectWithValue:n,extra:{searchAPIClient:r}})=>{const i=t(),o=(new Date).getTime(),u=await r.productRecommendations(qr(i)),s=(new Date).getTime()-o;return tn(u)?n(u.error):{recommendations:u.success.results.map(jr),analyticsAction:yr(),searchUid:u.success.searchUid,duration:s}})),jr=e=>({sku:e.raw.productid||e.raw.sku,name:e.raw.ec_name||e.title,thumbnailUrl:e.raw.ec_image||e.raw.image,link:e.clickUri,price:e.raw.ec_price||e.raw.price,promoPrice:e.raw.ec_promo_price||e.raw.promo_price,rating:e.raw.ec_rating||e.raw.rating,tags:e.raw.tags,brand:e.raw.ec_brand||e.raw.brand,categories:e.raw.ec_categories||e.raw.categories,inStock:e.raw.ec_in_stock||e.raw.in_stock}),qr=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,...e.configuration.analytics.enabled&&{visitorId:or()},recommendation:e.productRecommendations.id,numberOfResults:e.productRecommendations.maxNumberOfRecommendations,mlParameters:{...e.productRecommendations.skus&&e.productRecommendations.skus.length>0&&{itemIds:e.productRecommendations.skus},...e.productRecommendations.filter.brand&&{brandFilter:e.productRecommendations.filter.brand},...e.productRecommendations.filter.category&&{categoryFilter:e.productRecommendations.filter.category}},actionsHistory:e.configuration.analytics.enabled?ur.getHistory():[],...e.context&&{context:e.context.contextValues},...e.searchHub&&{searchHub:e.searchHub}}),Ir=xe({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},(e=>{e.addCase(pr,((e,t)=>{e.id=t.payload.id})).addCase(gr,((e,t)=>{e.skus=t.payload.skus})).addCase(br,((e,t)=>{e.filter.brand=t.payload.brand})).addCase(wr,((e,t)=>{e.filter.category=t.payload.category})).addCase(Or,((e,t)=>{e.maxNumberOfRecommendations=t.payload.number})).addCase(Sr.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Sr.fulfilled,((e,t)=>{e.error=null,e.searchUid=t.payload.searchUid,e.recommendations=t.payload.recommendations,e.isLoading=!1})).addCase(Sr.pending,(e=>{e.isLoading=!0}))})),Ar=Ae("searchHub/set",(e=>Xe(e,new Ye({required:!0,emptyAllowed:!0})))),xr=xe("default",(e=>{e.addCase(Ar,((e,t)=>t.payload)).addCase(Ut.fulfilled,((e,t)=>t.payload.searchHub)).addCase(ut,((e,t)=>t.payload.searchHub||e))})),Cr={configuration:Tt,productRecommendations:Ir,context:Bt,searchHub:xr},Mr=cr("analytics/recommendation/update",ar.Search,(e=>e.logRecommendationInterfaceLoad())),Rr=Ae("recommendation/set",(e=>Xe(e,{id:We}))),Er=Ee("recommendation/get",(async(e,{getState:t,rejectWithValue:n,extra:{searchAPIClient:r}})=>{const i=t(),o=(new Date).getTime(),u=await r.recommendations(Tr(i)),s=(new Date).getTime()-o;return tn(u)?n(u.error):{recommendations:u.success.results,analyticsAction:Mr(),duration:s}})),Tr=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,actionsHistory:e.configuration.analytics.enabled?ur.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude}}),kr=cr("analytics/didyoumean/click",ar.Search,(e=>e.logDidYouMeanClick())),Pr=cr("analytics/didyoumean/automatic",ar.Search,(e=>e.logDidYouMeanAutomatic())),Vr=Ae("didYouMean/enable"),Fr=Ae("didYouMean/disable"),Dr=Ae("didYouMean/correction",(e=>Xe(e,We))),_r=Ae("query/updateQuery",(e=>Xe(e,{q:new Ye,enableQuerySyntax:new Ne})));var Nr,$r;!function(e){e.Ascending="ascending",e.Descending="descending"}(Nr||(Nr={})),function(e){e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort"}($r||($r={}));const Lr=e=>{if(Qe(e))return e.map((e=>Lr(e))).join(",");switch(e.by){case $r.Relevancy:case $r.QRE:case $r.NoSort:return e.by;case $r.Date:return"date "+e.order;case $r.Field:return`@${e.field} ${e.order}`;default:return console.error("Unknown criterion: "+e),""}},Yr=()=>({by:$r.Relevancy}),Hr=e=>({by:$r.Date,order:e}),zr=(e,t)=>({by:$r.Field,order:t,field:e});function Ur(){return Lr(Yr())}const Br=cr("search/logFetchMoreResults",ar.Search,(e=>e.logFetchMoreResults())),Qr=e=>cr("search/queryError",ar.Search,((t,n)=>{var r,i,o;return t.logQueryError({query:(null===(r=n.query)||void 0===r?void 0:r.q)||"",aq:(null===(i=n.advancedSearchQueries)||void 0===i?void 0:i.aq)||"",cq:(null===(o=n.advancedSearchQueries)||void 0===o?void 0:o.cq)||"",dq:"",errorType:e.type,errorMessage:e.message})}))();function Jr(e,t){const n={};return e.forEach((e=>n[e.facetId]=e)),t.map((e=>n[e])).filter((e=>void 0!==e))}const Wr=async(e,t,n)=>{var r;const i=(new Date).getTime();return{response:await e.search(n),duration:(new Date).getTime()-i,queryExecuted:(null===(r=t.query)||void 0===r?void 0:r.q)||"",requestExecuted:n}},Zr=Ee("search/executeSearch",(async(e,{getState:t,dispatch:n,rejectWithValue:r,extra:{searchAPIClient:i}})=>{const o=t();ai(o);const u=await Wr(i,o,ti(o));if(tn(u.response))return n(Qr(u.response.error)),r(u.response.error);if(!Xr(o,u.response.success))return n(Yt(ei(o))),{...u,response:u.response.success,automaticallyCorrected:!1,analyticsAction:e};n(e);const s=await Gr(i,u.response.success.queryCorrections[0].correctedQuery,t,n);return tn(s.response)?(n(Qr(s.response.error)),r(s.response.error)):(n(Yt(ei(t()))),{...s,response:{...s.response.success,queryCorrections:u.response.success.queryCorrections},automaticallyCorrected:!0,analyticsAction:Pr()})})),Kr=Ee("search/fetchMoreResults",(async(e,{getState:t,dispatch:n,rejectWithValue:r,extra:{searchAPIClient:i}})=>{const o=t(),u=await Wr(i,o,ni(o));return tn(u.response)?(n(Qr(u.response.error)),r(u.response.error)):(n(Yt(ei(o))),{...u,response:u.response.success,automaticallyCorrected:!1,analyticsAction:Br()})})),Gr=async(e,t,n,r)=>{r(_r({q:t}));const i=await Wr(e,n(),ti(n()));return r(Dr(t)),i},Xr=(e,t)=>{var n;return!0===(null===(n=e.didYouMean)||void 0===n?void 0:n.enableDidYouMean)&&0===t.results.length&&0!==t.queryCorrections.length},ei=e=>{var t,n;return{context:e.context||{contextValues:{}},facetSet:e.facetSet||{},numericFacetSet:e.numericFacetSet||{},dateFacetSet:e.dateFacetSet||{},categoryFacetSet:e.categoryFacetSet||{},pagination:e.pagination||{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:e.query||{q:"",enableQuerySyntax:!1},advancedSearchQueries:e.advancedSearchQueries||{cq:"",aq:""},querySet:e.querySet||{},sortCriteria:e.sortCriteria||Ur(),pipeline:e.pipeline||"default",searchHub:e.searchHub||"default",facetOptions:e.facetOptions||{freezeFacetOrder:!1},facetOrder:null!==(t=e.facetOrder)&&void 0!==t?t:[],debug:null!==(n=e.debug)&&void 0!==n&&n}},ti=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,debug:e.debug,...e.configuration.analytics.enabled&&{visitorId:or()},...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.context&&{context:e.context.contextValues},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...e.facetSet&&{facets:ri(e)},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.pagination&&{numberOfResults:e.pagination.numberOfResults,firstResult:e.pagination.firstResult},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.facetOptions&&{facetOptions:e.facetOptions}}),ni=e=>{var t,n,r,i;return{...ti(e),firstResult:(null!==(n=null===(t=e.pagination)||void 0===t?void 0:t.firstResult)&&void 0!==n?n:0)+(null!==(i=null===(r=e.search)||void 0===r?void 0:r.results.length)&&void 0!==i?i:0)}};function ri(e){return[...ii(e),...oi(e)]}function ii(e){var t;return Jr(ui(e),null!==(t=e.facetOrder)&&void 0!==t?t:[])}function oi(e){var t;const n=null!==(t=e.facetOrder)&&void 0!==t?t:[];return ui(e).filter((e=>-1===n.indexOf(e.facetId)))}function ui(e){return[...si(e.facetSet),...si(e.numericFacetSet),...si(e.dateFacetSet),...si(e.categoryFacetSet)]}function si(e={}){return Object.keys(e).map((t=>e[t]))}const ai=e=>{var t;e.configuration.analytics.enabled&&ur.addElement({name:"Query",value:(null===(t=e.query)||void 0===t?void 0:t.q)||"",time:JSON.stringify(new Date)})},ci=e=>t=>n=>{var r,i;const o=null===(r=n.payload)||void 0===r?void 0:r.analyticsAction;void 0!==o&&(null===(i=n.payload)||void 0===i||delete i.analyticsAction);const u=t(n);return n.type===Zr.fulfilled.type&&void 0===o&&console.error("No analytics action associated with search:",n),n.type===Er.fulfilled&&void 0===o&&console.error("No analytics action associated with recommendation:",n),n.type===Sr.fulfilled&&void 0===o&&console.error("No analytics action associated with product recommendation:",n),void 0!==o&&e.dispatch(o),u},li=e=>()=>t=>n=>{if(!n.error)return t(n);const r=n.error;return e.error(r.stack||r.message||r.name||"Error","Action dispatch error "+n.type,n),"SchemaValidationError"!==n.error.name?t(n):void 0},di=e=>t=>n=>r=>(e.debug({action:r,nextState:t.getState()},"Action dispatched: "+r.type),n(r));function fi(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}var hi=function(e,t,n){var r=n&&n.stringify||fi;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var o=new Array(i);o[0]=r(e);for(var u=1;u<i;u++)o[u]=r(t[u]);return o.join(" ")}if("string"!=typeof e)return e;var s=t.length;if(0===s)return e;for(var a="",c=0,l=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:if(c>=s)break;if(l<f&&(a+=e.slice(l,f)),null==t[c])break;a+=Number(t[c]),l=f+=2;break;case 79:case 111:case 106:if(c>=s)break;if(l<f&&(a+=e.slice(l,f)),void 0===t[c])break;var h=typeof t[c];if("string"===h){a+="'"+t[c]+"'",l=f+2,f++;break}if("function"===h){a+=t[c].name||"<anonymous>",l=f+2,f++;break}a+=r(t[c]),l=f+2,f++;break;case 115:if(c>=s)break;l<f&&(a+=e.slice(l,f)),a+=String(t[c]),l=f+2,f++;break;case 37:l<f&&(a+=e.slice(l,f)),a+="%",l=f+2,f++}++c}++f}return-1===l?e:(l<d&&(a+=e.slice(l)),a)},vi=pi,mi=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},yi={mapHttpRequest:Ii,mapHttpResponse:Ii,wrapRequestSerializer:Ai,wrapResponseSerializer:Ai,wrapErrorSerializer:Ai,req:Ii,res:Ii,err:function(e){var t={type:e.constructor.name,msg:e.message,stack:e.stack};for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}};function pi(e){(e=e||{}).browser=e.browser||{};var t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");var n=e.browser.write||mi;e.browser.write&&(e.browser.asObject=!0);var r=e.serializers||{},i=Array.isArray(e.browser.serialize)?e.browser.serialize.filter((function(e){return"!stdSerializers.err"!==e})):!0===e.browser.serialize&&Object.keys(r),o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1),"function"==typeof n&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),!1===e.enabled&&(e.level="silent");var u=e.level||"info",s=Object.create(n);s.log||(s.log=xi),Object.defineProperty(s,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(s,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,gi(a,s,"error","log"),gi(a,s,"fatal","error"),gi(a,s,"warn","error"),gi(a,s,"info","log"),gi(a,s,"debug","log"),gi(a,s,"trace","log")}});var a={transmit:t,serialize:i,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:qi(e)};return s.levels=pi.levels,s.level=u,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=xi,s.serializers=r,s._serialize=i,s._stdErrSerialize=o,s.child=function(n){if(!n)throw new Error("missing bindings for child Pino");var o=n.serializers;if(i&&o){var u=Object.assign({},r,o),s=!0===e.browser.serialize?Object.keys(u):i;delete n.serializers,wi([n],s,u,this._stdErrSerialize)}function a(e){this._childLevel=1+(0|e._childLevel),this.error=Oi(e,n,"error"),this.fatal=Oi(e,n,"fatal"),this.warn=Oi(e,n,"warn"),this.info=Oi(e,n,"info"),this.debug=Oi(e,n,"debug"),this.trace=Oi(e,n,"trace"),u&&(this.serializers=u,this._serialize=s),t&&(this._logEvent=ji([].concat(e._logEvent.bindings,n)))}return a.prototype=this,new a(this)},t&&(s._logEvent=ji()),s}function gi(e,t,n,r){var i=Object.getPrototypeOf(t);t[n]=t.levelVal>t.levels.values[n]?xi:i[n]?i[n]:mi[n]||mi[r]||xi,function(e,t,n){var r;(e.transmit||t[n]!==xi)&&(t[n]=(r=t[n],function(){for(var i=e.timestamp(),o=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===mi?mi:this,s=0;s<o.length;s++)o[s]=arguments[s];if(e.serialize&&!e.asObject&&wi(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?r.call(u,bi(this,n,o,i)):r.apply(u,o),e.transmit){var a=e.transmit.level||t.level,c=pi.levels.values[a],l=pi.levels.values[n];if(l<c)return;Si(this,{ts:i,methodLevel:n,methodValue:l,transmitLevel:a,transmitValue:pi.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}}))}(e,t,n)}function bi(e,t,n,r){e._serialize&&wi(n,e._serialize,e.serializers,e._stdErrSerialize);var i=n.slice(),o=i[0],u={};r&&(u.time=r),u.level=pi.levels.values[t];var s=1+(0|e._childLevel);if(s<1&&(s=1),null!==o&&"object"==typeof o){for(;s--&&"object"==typeof i[0];)Object.assign(u,i.shift());o=i.length?hi(i.shift(),i):void 0}else"string"==typeof o&&(o=hi(i.shift(),i));return void 0!==o&&(u.msg=o),u}function wi(e,t,n,r){for(var i in e)if(r&&e[i]instanceof Error)e[i]=pi.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(var o in e[i])t&&t.indexOf(o)>-1&&o in n&&(e[i][o]=n[o](e[i][o]))}function Oi(e,t,n){return function(){var r=new Array(1+arguments.length);r[0]=t;for(var i=1;i<r.length;i++)r[i]=arguments[i-1];return e[n].apply(this,r)}}function Si(e,t,n){var r=t.send,i=t.ts,o=t.methodLevel,u=t.methodValue,s=t.val,a=e._logEvent.bindings;wi(n,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=n.filter((function(e){return-1===a.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=u,r(o,e._logEvent,s),e._logEvent=ji(a)}function ji(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function qi(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?Ci:Mi}function Ii(){return{}}function Ai(e){return e}function xi(){}function Ci(){return!1}function Mi(){return Date.now()}pi.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},pi.stdSerializers=yi,pi.stdTimeFunctions=Object.assign({},{nullTime:Ci,epochTime:Mi,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const Ri=e=>e,Ei=e=>e,Ti=e=>e;class ki{constructor(e){if(this.options=e,this.accessTokenRenewalsAttempts=0,this.resetRenewalTriesAfterDelay=function(e,t,n){var r;return void 0===t&&(t=50),void 0===n&&(n={isImmediate:!1}),function(){for(var i=[],o=arguments.length;o--;)i[o]=arguments[o];var u=this,s=n.isImmediate&&void 0===r;void 0!==r&&clearTimeout(r),r=setTimeout((function(){r=void 0,n.isImmediate||e.apply(u,i)}),t),s&&e.apply(u,i)}}((()=>this.accessTokenRenewalsAttempts=0),500),this.initLogger(),this.validateConfiguration(e),this.initStore(),this.reduxStore.dispatch(ot({accessToken:e.configuration.accessToken,platformUrl:e.configuration.platformUrl,organizationId:e.configuration.organizationId})),e.configuration.search&&this.reduxStore.dispatch(ut(e.configuration.search)),e.configuration.analytics){const{analyticsClientMiddleware:t,...n}=e.configuration.analytics;this.reduxStore.dispatch(st(n))}}validateConfiguration(e){const t=new ke({organizationId:new Ye({required:!0,emptyAllowed:!1}),accessToken:new Ye({required:!0,emptyAllowed:!1}),platformUrl:new Ye({required:!1,emptyAllowed:!1}),search:new ze({options:{required:!1},values:{pipeline:new Ye({required:!1,emptyAllowed:!1}),searchHub:new Ye({required:!1,emptyAllowed:!1})}})});try{t.validate(e.configuration)}catch(e){throw this.logger.error(e,"Headless engine configuration error"),e}}initLogger(){var e,t,n;this.logger=vi({name:"@coveo/headless",level:(null===(e=this.options.loggerOptions)||void 0===e?void 0:e.level)||"warn",formatters:{log:null===(t=this.options.loggerOptions)||void 0===t?void 0:t.logFormatter},browser:{transmit:{send:(null===(n=this.options.loggerOptions)||void 0===n?void 0:n.browserPostLogHook)||(()=>{})}}})}initStore(){const{search:e}=this.options.configuration;this.reduxStore=function({reducers:e,preloadedState:t,middlewares:n=[],thunkExtraArguments:r}){return function(e){var t,n=function(e){return Ie(e)},r=e||{},i=r.reducer,o=void 0===i?void 0:i,u=r.middleware,s=void 0===u?n():u,a=r.devTools,c=void 0===a||a,l=r.preloadedState,d=void 0===l?void 0:l,f=r.enhancers,h=void 0===f?void 0:f;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=re(o)}var v=ce.apply(void 0,"function"==typeof s?s(n):s),m=ae;c&&(m=je(pe({trace:!1},"object"==typeof c&&c)));var y=[v];return Array.isArray(h)?y=[v].concat(h):"function"==typeof h&&(y=h(y)),te(t,d,m.apply(void 0,y))}({reducer:re(e),preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e},middleware:e=>[li(r.logger),ci,...n,...e({thunk:{extraArgument:r}}),di(r.logger)]})}({preloadedState:this.options.preloadedState,reducers:this.options.reducers,middlewares:this.options.middlewares,thunkExtraArguments:{searchAPIClient:new Kt({logger:this.logger,renewAccessToken:()=>this.renewAccessToken(),preprocessRequest:(null==e?void 0:e.preprocessRequestMiddleware)||Ct,postprocessSearchResponseMiddleware:(null==e?void 0:e.preprocessSearchResponseMiddleware)||Ri,postprocessFacetSearchResponseMiddleware:(null==e?void 0:e.preprocessFacetSearchResponseMiddleware)||Ei,postprocessQuerySuggestResponseMiddleware:(null==e?void 0:e.preprocessQuerySuggestResponseMiddleware)||Ti}),analyticsClientMiddleware:this.analyticsClientMiddleware(this.options),logger:this.logger,validatePayload:Ge}})}static getSampleConfiguration(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",search:{pipeline:"default",searchHub:"default"}}}enableAnalytics(){this.dispatch(lt())}disableAnalytics(){this.dispatch(ct())}get store(){return this.reduxStore}get dispatch(){return this.reduxStore.dispatch}get subscribe(){return this.reduxStore.subscribe}get state(){return this.reduxStore.getState()}async renewAccessToken(){if(!this.options.configuration.renewAccessToken)return"";if(this.accessTokenRenewalsAttempts++,this.resetRenewalTriesAfterDelay(),this.accessTokenRenewalsAttempts>5)return"";try{const e=await this.options.configuration.renewAccessToken();return this.dispatch(ot({accessToken:e})),e}catch(e){return""}}analyticsClientMiddleware(e){var t;return(null===(t=e.configuration.analytics)||void 0===t?void 0:t.analyticsClientMiddleware)||((e,t)=>t)}}const Pi={id:We},Vi=Ae("querySuggest/register",(e=>Xe(e,{...Pi,q:new Ye,count:new De({min:0})}))),Fi=Ae("querySuggest/unregister",(e=>Xe(e,Pi))),Di=Ae("querySuggest/selectSuggestion",(e=>Xe(e,{...Pi,expression:Ze}))),_i=Ae("querySuggest/clear",(e=>Xe(e,Pi))),Ni=Ae("querySuggest/clearSuggestions",(e=>Xe(e,Pi))),$i=Ee("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:n,extra:{searchAPIClient:r,validatePayload:i}})=>{i(e,Pi);const o=e.id,u=await r.querySuggest(Li(o,t()));return tn(u)?n({id:o,...u.error}):{id:o,...u.success}})),Li=(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySuggest[e].q,actionsHistory:t.configuration.analytics.enabled?ur.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub}}),Yi={q:new Ye,enableQuerySyntax:new Ne,aq:new Ye,cq:new Ye,firstResult:new De({min:0}),numberOfResults:new De({min:0}),sortCriteria:new Ye,f:new ze,cf:new ze,nf:new ze,df:new ze,debug:new Ne},Hi=Ae("searchParameters/restore",(e=>Xe(e,Yi))),zi=xe({q:"",enableQuerySyntax:!1},(e=>e.addCase(_r,((e,t)=>({...e,...t.payload}))).addCase(Dr,((e,t)=>{e.q=t.payload})).addCase(Di,((e,t)=>{e.q=t.payload.expression})).addCase(Ut.fulfilled,((e,t)=>t.payload.query)).addCase(Hi,((e,t)=>{var n,r;e.q=null!==(n=t.payload.q)&&void 0!==n?n:e.q,e.enableQuerySyntax=null!==(r=t.payload.enableQuerySyntax)&&void 0!==r?r:e.enableQuerySyntax}))));function Ui(e){return"redirect"===e.type}class Bi{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){const e=this.response.preprocessingOutput.triggers.filter(Ui);return e.length?e[0].content:null}}const Qi=cr("analytics/trigger/redirection",ar.Search,((e,t)=>{if(t.redirection&&null!==t.redirection.redirectTo)return e.logTriggerRedirect({redirectedTo:t.redirection.redirectTo})})),Ji=Ee("redirection/check",(async(e,{dispatch:t,getState:n,rejectWithValue:r,extra:{searchAPIClient:i,validatePayload:o}})=>{o(e,{defaultRedirectionUrl:new Ye({emptyAllowed:!1,url:!0})});const u=await i.plan(Wi(n()));if(tn(u))return r(u.error);const s=new Bi(u.success).redirectionUrl;return s&&t(Qi()),s||e.defaultRedirectionUrl})),Wi=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub}}),Zi=xe({redirectTo:null},(e=>e.addCase(Ji.fulfilled,((e,t)=>{e.redirectTo=t.payload})))),Ki={id:We,query:Ze},Gi=Ae("querySet/register",(e=>Xe(e,Ki))),Xi=Ae("querySet/update",(e=>Xe(e,Ki))),eo=xe({},(e=>e.addCase(Vi,((e,t)=>{e[t.payload.id]={id:"",completions:[],count:5,q:"",currentRequestId:"",error:null,partialQueries:[],...t.payload}})).addCase(Fi,((e,t)=>{delete e[t.payload.id]})).addCase($i.pending,((e,t)=>{e[t.meta.arg.id].currentRequestId=t.meta.requestId})).addCase($i.fulfilled,((e,t)=>{var n;const r=t.meta.arg.id;if(t.meta.requestId===(null===(n=e[r])||void 0===n?void 0:n.currentRequestId)){const{q:n}=e[r];n&&e[r].partialQueries.push(n),e[r].completions=t.payload.completions}})).addCase($i.rejected,((e,t)=>{e[t.payload.id].error=t.payload})).addCase(Xi,((e,t)=>{const{id:n,query:r}=t.payload;n in e&&(e[n].q=r)})).addCase(_i,((e,t)=>{const{id:n}=t.payload;e[n].q="",e[n].completions=[]})).addCase(Ni,((e,t)=>{e[t.payload.id].completions=[]})).addCase(Di,((e,t)=>{const{id:n,expression:r}=t.payload;e[n].q=r,e[n].completions=[]})).addCase(Zr.fulfilled,(e=>{for(const t of Object.values(e))t&&(t.partialQueries=[])})))),to=xe({},(e=>{e.addCase(Gi,((e,t)=>{const{id:n,query:r}=t.payload;n in e||(e[n]=r)})).addCase(Xi,((e,t)=>{const{id:n,query:r}=t.payload;no(e,n,r)})).addCase(Di,((e,t)=>{const{id:n,expression:r}=t.payload;no(e,n,r)})).addCase(Zr.fulfilled,((e,t)=>{const{queryExecuted:n}=t.payload;Object.keys(e).forEach((t=>e[t]=n))})).addCase(Ut.fulfilled,((e,t)=>{for(const[n,r]of Object.entries(t.payload.querySet))no(e,n,r)}))})),no=(e,t,n)=>{t in e&&(e[t]=n)};function ro(e,t){e.error=t.payload?t.payload:null,e.isLoading=!1}function io(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function oo(e){e.isLoading=!0}const uo=xe({response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[]},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},(e=>{e.addCase(Zr.rejected,ro),e.addCase(Kr.rejected,ro),e.addCase(Zr.fulfilled,((e,t)=>{io(e,t),e.results=t.payload.response.results})),e.addCase(Kr.fulfilled,((e,t)=>{io(e,t),e.results=[...e.results,...t.payload.response.results]})),e.addCase(Zr.pending,oo),e.addCase(Kr.pending,oo)})),so=new De({required:!0,min:0}),ao=Ae("pagination/registerNumberOfResults",(e=>Xe(e,so))),co=Ae("pagination/updateNumberOfResults",(e=>Xe(e,so))),lo=Ae("pagination/registerPage",(e=>Xe(e,so))),fo=Ae("pagination/updatePage",(e=>Xe(e,so))),ho=Ae("pagination/nextPage"),vo=Ae("pagination/previousPage"),mo=xe({firstResult:0,numberOfResults:10,totalCountFiltered:0},(e=>{e.addCase(ao,((e,t)=>{const n=yo(e),r=t.payload;e.numberOfResults=r,e.firstResult=po(n,r)})).addCase(co,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(lo,((e,t)=>{e.firstResult=po(t.payload,e.numberOfResults)})).addCase(fo,((e,t)=>{e.firstResult=po(t.payload,e.numberOfResults)})).addCase(vo,(e=>{const t=yo(e),n=Math.max(t-1,1);e.firstResult=po(n,e.numberOfResults)})).addCase(ho,(e=>{const t=yo(e),n=function(e){const{totalCountFiltered:t,numberOfResults:n}=e;return bo(t,n)}(e),r=Math.min(t+1,n);e.firstResult=po(r,e.numberOfResults)})).addCase(Ut.fulfilled,((e,t)=>{e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult})).addCase(Hi,((e,t)=>{var n,r;e.firstResult=null!==(n=t.payload.firstResult)&&void 0!==n?n:e.firstResult,e.numberOfResults=null!==(r=t.payload.numberOfResults)&&void 0!==r?r:e.numberOfResults})).addCase(Zr.fulfilled,((e,t)=>{const{response:n}=t.payload;e.totalCountFiltered=n.totalCountFiltered}))}));function yo(e){const{firstResult:t,numberOfResults:n}=e;return go(t,n)}function po(e,t){return(e-1)*t}function go(e,t){return e/t+1}function bo(e,t){const n=Math.min(e,1e3);return Math.ceil(n/t)}const wo={by:new Je({enum:$r,required:!0})},Oo=Ae("sortCriteria/register",(e=>jo(e))),So=Ae("sortCriteria/update",(e=>jo(e))),jo=e=>Qe(e)?(e.forEach((e=>Xe(e,wo))),{payload:e}):Xe(e,wo),qo=xe(Ur(),(e=>{e.addCase(Oo,((e,t)=>Lr(t.payload))).addCase(So,((e,t)=>Lr(t.payload))).addCase(Ut.fulfilled,((e,t)=>t.payload.sortCriteria)).addCase(Hi,((e,t)=>{var n;return null!==(n=t.payload.sortCriteria)&&void 0!==n?n:e}))})),Io=We,Ao={value:We,numberOfResults:new De({min:0}),state:We},xo={facetId:Io,field:new Ye({required:!0,emptyAllowed:!0}),delimitingCharacter:new Ye({required:!1,emptyAllowed:!0}),filterFacetCount:new Ne({required:!1}),injectionDepth:new De({required:!1,min:0}),numberOfValues:new De({required:!1,min:1}),sortCriteria:new Pe({required:!1})},Co=Ae("facet/register",(e=>Xe(e,xo))),Mo=Ae("facet/toggleSelectValue",(e=>Xe(e,{facetId:Io,selection:new ze({values:Ao})}))),Ro=Ae("facet/deselectAll",(e=>Xe(e,Io))),Eo=Ae("facet/updateSortCriterion",(e=>Xe(e,{facetId:Io,criterion:new Pe({required:!0})}))),To=Ae("facet/updateNumberOfValues",(e=>Xe(e,{facetId:Io,numberOfValues:new De({required:!0,min:1})}))),ko=Ae("facet/updateIsFieldExpanded",(e=>Xe(e,{facetId:Io,isFieldExpanded:new Ne({required:!0})}))),Po={facetId:Io,captions:new ze({options:{required:!1}}),numberOfValues:new De({required:!1,min:1}),query:new Ye({required:!1,emptyAllowed:!0})},Vo={facetId:Io,value:new ze({values:{displayValue:Ze,rawValue:Ze,count:new De({required:!0,min:0})}})},Fo=Ae("facetSearch/register",(e=>Xe(e,Po))),Do=Ae("facetSearch/update",(e=>Xe(e,Po))),_o=Ae("facetSearch/toggleSelectValue",(e=>Xe(e,Vo)));function No(e,t){const{facetId:n,criterion:r}=t,i=e[n];i&&(i.sortCriteria=r)}function $o(e,t){const n=e[t];n&&(n.currentValues=[],n.preventAutoSelect=!0)}function Lo(e,t){const{facetId:n,numberOfValues:r}=t,i=e[n];i&&(i.numberOfValues=r)}const Yo=Ae("facet/deselectAllFacets"),Ho=xe({},(e=>{e.addCase(Co,((e,t)=>{const{facetId:n}=t.payload;var r;n in e||(e[n]=(r=t.payload,{...zo,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...r}))})).addCase(Ut.fulfilled,((e,t)=>{if(0!==Object.keys(t.payload.facetSet).length)return t.payload.facetSet})).addCase(Hi,((e,t)=>{const n=t.payload.f||{};Object.keys(e).forEach((t=>{const r=e[t],i=n[t]||[];r.currentValues=i.map(Bo),r.preventAutoSelect=!0,r.numberOfValues=Math.max(i.length,r.numberOfValues)}))})).addCase(Mo,((e,t)=>{const{facetId:n,selection:r}=t.payload,i=e[n];if(!i)return;const o=i.currentValues.find((e=>e.value===r.value));o&&(o.state="selected"===o.state?"idle":"selected",i.freezeCurrentValues=!0,i.preventAutoSelect=!0)})).addCase(Ro,((e,t)=>{$o(e,t.payload)})).addCase(Yo,(e=>{Object.keys(e).forEach((t=>{$o(e,t)}))})).addCase(Eo,((e,t)=>{No(e,t.payload)})).addCase(To,((e,t)=>{Lo(e,t.payload)})).addCase(ko,((e,t)=>{const{facetId:n,isFieldExpanded:r}=t.payload,i=e[n];i&&(i.isFieldExpanded=r)})).addCase(Zr.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>{const n=e[t.facetId];n&&(n.currentValues=t.values.map(Uo),n.freezeCurrentValues=!1,n.preventAutoSelect=!1)}))})).addCase(_o,((e,t)=>{const{facetId:n,value:r}=t.payload,i=e[n];if(!i)return;const{rawValue:o}=r,{currentValues:u}=i,s=u.find((e=>e.value===o));if(s)return void(s.state="selected");const a=Bo(o),c=u.findIndex((e=>"idle"===e.state)),l=-1===c?u.length:c,d=u.slice(0,l),f=u.slice(l+1);i.currentValues=[...d,a,...f],i.numberOfValues=i.currentValues.length}))})),zo={delimitingCharacter:">",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic"};function Uo(e){const{value:t,state:n}=e;return{value:t,state:n}}function Bo(e){return{value:e,state:"selected"}}function Qo(){return{context:{contextValues:{}},facetSet:{},dateFacetSet:{},numericFacetSet:{},categoryFacetSet:{},facetOptions:{freezeFacetOrder:!1},pagination:{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:{q:"",enableQuerySyntax:!1},advancedSearchQueries:{cq:"",aq:""},sortCriteria:Ur(),querySet:{},pipeline:"default",searchHub:"default",debug:!1,facetOrder:[]}}const Jo=xe(Qo(),(e=>{e.addCase(Yt,((e,t)=>Wo(e,t.payload)?void 0:t.payload))})),Wo=(e,t)=>Zo(e.context,t.context)&&iu(e.advancedSearchQueries,t.advancedSearchQueries)&&Ko(e.facetSet,t.facetSet)&&Go(e.dateFacetSet,t.dateFacetSet)&&Xo(e.numericFacetSet,t.numericFacetSet)&&eu(e.categoryFacetSet,t.categoryFacetSet)&&tu(e.facetOptions,t.facetOptions)&&nu(e.pagination,t.pagination)&&ru(e.query,t.query)&&ou(e,t)&&uu(e.pipeline,t.pipeline)&&su(e.searchHub,t.searchHub)&&au(e.facetOrder,t.facetOrder)&&cu(e.debug,t.debug),Zo=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),Ko=(e,t)=>JSON.stringify(e)===JSON.stringify(t),Go=(e,t)=>JSON.stringify(e)===JSON.stringify(t),Xo=(e,t)=>JSON.stringify(e)===JSON.stringify(t),eu=(e,t)=>JSON.stringify(e)===JSON.stringify(t),tu=(e,t)=>JSON.stringify(e)===JSON.stringify(t),nu=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,ru=(e,t)=>JSON.stringify(e)===JSON.stringify(t),iu=(e,t)=>JSON.stringify(e)===JSON.stringify(t),ou=(e,t)=>e.sortCriteria===t.sortCriteria,uu=(e,t)=>e===t,su=(e,t)=>e===t,au=(e,t)=>{return(n=e).length===(r=t).length&&-1===n.findIndex(((e,t)=>r[t]!==e));var n,r},cu=(e,t)=>e===t,lu=xe({enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[]}},(e=>{e.addCase(Vr,(e=>{e.enableDidYouMean=!0})).addCase(Fr,(e=>{e.enableDidYouMean=!1})).addCase(Zr.pending,(e=>{e.queryCorrection={correctedQuery:"",wordCorrections:[]},e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(Zr.fulfilled,((e,t)=>{e.queryCorrection=t.payload.response.queryCorrections[0]||{correctedQuery:"",wordCorrections:[]},e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected})).addCase(Dr,((e,t)=>{e.wasCorrectedTo=t.payload}))}));function du(e,t,n){const{facetId:r}=t;if(e[r])return;const i=function(e={}){return{...yu,...e}}(t),o=n();e[r]={options:i,isLoading:!1,response:o}}function fu(e,t){const{facetId:n,...r}=t,i=e[n];i&&(i.options={...i.options,...r})}function hu(e,t){const n=e[t];n&&(n.isLoading=!0)}function vu(e,t){const n=e[t];n&&(n.isLoading=!1)}function mu(e,t){const{facetId:n,response:r}=t,i=e[n];i&&(i.isLoading=!1,i.response=r)}const yu={captions:{},numberOfValues:10,query:""},pu=(e,t)=>{const n=Iu(t,e).field;return{facetId:e,facetField:n,facetTitle:`${n}_${e}`}};function gu(e,t){const{facetId:n,facetValue:r}=e;return{...pu(n,t),facetValue:r}}function bu(e){return{facetSet:e.facetSet||{},categoryFacetSet:e.categoryFacetSet||{},dateFacetSet:e.dateFacetSet||{},numericFacetSet:e.numericFacetSet||{},search:e.search||{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[]},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]}}}const wu=e=>{const t=[];return e.search.response.facets.forEach(((n,r)=>{n.values.forEach(((i,o)=>{if("selected"===i.state){const u=Au(e,n.facetId),s=qu(n,r+1),a=Ou(i,o+1,u),c="hierarchical"===u||"specific"===u?ju(i):Su(i);t.push({...s,...a,...c})}}))})),t},Ou=(e,t,n)=>({state:e.state,valuePosition:t,facetType:n}),Su=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),ju=e=>({displayValue:e.value,value:e.value}),qu=(e,t)=>({title:e.facetId,field:e.field,id:e.facetId,facetPosition:t}),Iu=(e,t)=>e.facetSet[t]||e.categoryFacetSet[t]||e.dateFacetSet[t]||e.numericFacetSet[t],Au=(e,t)=>{const n=Iu(e,t);return n?n.type:"specific"},xu=e=>cr("analytics/facet/showMore",ar.Search,((t,n)=>{Xe(e,Io);const r=pu(e,bu(n));return t.logFacetShowMore(r)}))(),Cu=e=>cr("analytics/facet/showLess",ar.Search,((t,n)=>{Xe(e,Io);const r=pu(e,bu(n));return t.logFacetShowLess(r)}))(),Mu=e=>cr("analytics/facet/search",ar.Search,((t,n)=>{Xe(e,Io);const r=bu(n),i=pu(e,r),o=wu(r);return t.logFacetSearch(i,o)}))(),Ru=e=>cr("analytics/facet/sortChange",ar.Search,((t,n)=>{Xe(e,{facetId:Io,criterion:new Pe({required:!0})});const{facetId:r,criterion:i}=e,o=bu(n),u={...pu(r,o),criteria:i},s=wu(o);return t.logFacetUpdateSort(u,s)}))(),Eu=e=>cr("analytics/facet/reset",ar.Search,((t,n)=>{Xe(e,Io);const r=bu(n),i=pu(e,r),o=wu(r);return t.logFacetClearAll(i,o)}))(),Tu=e=>cr("analytics/facet/select",ar.Search,((t,n)=>{Xe(e,{facetId:Io,facetValue:We});const r=bu(n),i=gu(e,r),o=wu(r);return t.logFacetSelect(i,o)}))(),ku=e=>cr("analytics/facet/deselect",ar.Search,((t,n)=>{Xe(e,{facetId:Io,facetValue:We});const r=bu(n),i=gu(e,r),o=wu(r);return t.logFacetDeselect(i,o)}))(),Pu=Ee("facetSearch/executeSearch",(async(e,{dispatch:t,getState:n,extra:{searchAPIClient:r,validatePayload:i}})=>{const o=n();let u;i(e,We),u=Vu(o,e)?((e,t)=>{const{captions:n,query:r,numberOfValues:i}=t.facetSearchSet[e].options,{field:o,delimitingCharacter:u,currentValues:s}=t.facetSet[e],a=ti(t),c=s.filter((e=>"idle"!==e.state)).map((e=>e.value));return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,captions:n,numberOfValues:i,query:r,field:o,delimitingCharacter:u,ignoreValues:c,searchContext:a,type:"specific"}})(e,o):((e,t)=>{const n=t.categoryFacetSearchSet[e].options,r=t.categoryFacetSet[e],{captions:i,query:o,numberOfValues:u}=n,{field:s,delimitingCharacter:a,basePath:c}=r,l=ti(t),d=(e=>{const t=[];let n=e.currentValues[0];for(;n;)t.push(n.value),n=n.children[0];return t})(r);return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,basePath:c,captions:i,numberOfValues:u,query:o,field:s,delimitingCharacter:a,ignorePaths:d.length?[d]:[],searchContext:l,type:"hierarchical"}})(e,o);const s=await r.facetSearch(u);return t(Mu(e)),{facetId:e,response:s}})),Vu=(e,t)=>void 0!==e.facetSearchSet&&void 0!==e.facetSet&&void 0!==e.facetSet[t],Fu=xe({},(e=>{e.addCase(Fo,((e,t)=>{du(e,t.payload,Du)})).addCase(Do,((e,t)=>{fu(e,t.payload)})).addCase(Pu.pending,((e,t)=>{hu(e,t.meta.arg)})).addCase(Pu.rejected,((e,t)=>{vu(e,t.meta.arg)})).addCase(Pu.fulfilled,((e,t)=>{mu(e,t.payload)}))}));function Du(){return{moreValuesAvailable:!1,values:[]}}const _u=new Be({each:We,required:!0}),Nu=Ae("fields/registerFieldsToInclude",(e=>Xe(e,_u))),$u=xe({fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},(e=>e.addCase(Nu,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})))),Lu=Ae("pipeline/set",(e=>Xe(e,new Ye({required:!0,emptyAllowed:!0})))),Yu=xe("default",(e=>{e.addCase(Lu,((e,t)=>t.payload)).addCase(Ut.fulfilled,((e,t)=>t.payload.pipeline)).addCase(ut,((e,t)=>t.payload.pipeline||e))})),Hu=Ae("rangeFacet/updateSortCriterion",(e=>Xe(e,{facetId:Io,criterion:new Pe({required:!0})}))),zu={state:We,start:new De({required:!0}),end:new De({required:!0}),endInclusive:new Ne({required:!0}),numberOfResults:new De({required:!0,min:0})},Uu={start:We,end:We,endInclusive:new Ne({required:!0}),state:We,numberOfResults:new De({required:!0,min:0})},Bu={start:We,end:We,endInclusive:new Ne({required:!0}),state:We},Qu={facetId:Io,field:We,currentValues:new Be({required:!1,each:new ze({values:Bu})}),generateAutomaticRanges:new Ne({required:!0}),filterFacetCount:new Ne({required:!1}),injectionDepth:new De({required:!1,min:0}),numberOfValues:new De({required:!1,min:1}),sortCriteria:new Pe({required:!1})},Ju=Ae("dateFacet/register",(e=>Xe(e,Qu))),Wu=Ae("dateFacet/toggleSelectValue",(e=>Xe(e,{facetId:Io,selection:new ze({values:Uu})}))),Zu=Hu,Ku=Ro,Gu={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending"};function Xu(e,t){const{facetId:n}=t;if(n in e)return;const r=function(e){const{generateAutomaticRanges:t,currentValues:n,numberOfValues:r}=e;return t?Math.max(r,n.length):n.length}(t);e[n]={...t,numberOfValues:r}}function es(e,t,n){const r=e[t];if(!r)return;const i=is(r.currentValues,n);i&&(i.state="selected"===i.state?"idle":"selected",r.preventAutoSelect=!0)}function ts(e,t){const n=e[t];n&&n.currentValues.forEach((e=>e.state="idle"))}function ns(e,t){Object.entries(e).forEach((([e,n])=>{const r=t[e]||[];n.currentValues.forEach((e=>{const t=!!is(r,e);return e.state=t?"selected":"idle",e}));const i=r.filter((e=>!is(n.currentValues,e))),o=n.currentValues;o.push(...i),n.numberOfValues=Math.max(n.numberOfValues,o.length)}))}function rs(e,t,n){t.forEach((t=>{const r=e[t.facetId];if(!r)return;const i=n(t.values);r.currentValues=i,r.preventAutoSelect=!1}))}function is(e,t){const{start:n,end:r}=t;return e.find((e=>e.start===n&&e.end===r))}const os=xe({},(e=>{e.addCase(Ju,((e,t)=>{const{payload:n}=t;var r;Xu(e,(r=n,{...Gu,currentValues:[],preventAutoSelect:!1,type:"dateRange",...r}))})).addCase(Ut.fulfilled,((e,t)=>t.payload.dateFacetSet)).addCase(Hi,((e,t)=>{ns(e,t.payload.df||{})})).addCase(Wu,((e,t)=>{const{facetId:n,selection:r}=t.payload;es(e,n,r)})).addCase(Ku,((e,t)=>{ts(e,t.payload)})).addCase(Yo,(e=>{Object.keys(e).forEach((t=>{ts(e,t)}))})).addCase(Zu,((e,t)=>{No(e,t.payload)})).addCase(Zr.fulfilled,((e,t)=>{rs(e,t.payload.response.facets,us)}))}));function us(e){return e.map((e=>{const{numberOfResults:t,...n}=e;return n}))}const ss={state:We,start:new De({required:!0}),end:new De({required:!0}),endInclusive:new Ne({required:!0})},as={facetId:Io,field:We,currentValues:new Be({required:!1,each:new ze({values:ss})}),generateAutomaticRanges:new Ne({required:!0}),filterFacetCount:new Ne({required:!1}),injectionDepth:new De({required:!1,min:0}),numberOfValues:new De({required:!1,min:1}),sortCriteria:new Pe({required:!1})},cs=Ae("numericFacet/register",(e=>Xe(e,as))),ls=Ae("numericFacet/toggleSelectValue",(e=>Xe(e,{facetId:Io,selection:new ze({values:zu})}))),ds=Hu,fs=Ro,hs=xe({},(e=>{e.addCase(cs,((e,t)=>{const{payload:n}=t;var r;Xu(e,(r=n,{...Gu,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...r}))})).addCase(Ut.fulfilled,((e,t)=>t.payload.numericFacetSet)).addCase(Hi,((e,t)=>{ns(e,t.payload.nf||{})})).addCase(ls,((e,t)=>{const{facetId:n,selection:r}=t.payload;es(e,n,r)})).addCase(fs,((e,t)=>{ts(e,t.payload)})).addCase(Yo,(e=>{Object.keys(e).forEach((t=>{ts(e,t)}))})).addCase(ds,((e,t)=>{No(e,t.payload)})).addCase(Zr.fulfilled,((e,t)=>{rs(e,t.payload.response.facets,vs)}))}));function vs(e){return e.map((e=>{const{numberOfResults:t,...n}=e;return n}))}const ms={state:new Pe({required:!0}),numberOfResults:new De({required:!0,min:0}),value:new Ye({required:!0,emptyAllowed:!0}),path:new Be({required:!0,each:We}),moreValuesAvailable:new Ne({required:!1})};function ys(e){e.children.forEach((e=>{ys(e)})),Ge({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},ms)}const ps={facetId:Io,field:We,delimitingCharacter:new Ye({required:!1,emptyAllowed:!0}),filterFacetCount:new Ne({required:!1}),injectionDepth:new De({required:!1,min:0}),numberOfValues:new De({required:!1,min:1}),sortCriteria:new Pe({required:!1}),basePath:new Be({required:!1,each:We}),filterByBasePath:new Ne({required:!1})},gs=Ae("categoryFacet/register",(e=>Xe(e,ps))),bs=Ae("categoryFacet/toggleSelectValue",(e=>{try{return Ge(e.facetId,We),ys(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Ke(t)}}})),ws=Ro,Os=To,Ss=Ae("categoryFacet/updateSortCriterion",(e=>Xe(e,{facetId:Io,criterion:new Pe}))),js={path:new Be({required:!0,each:We}),displayValue:Ze,rawValue:Ze,count:new De({required:!0,min:0})},qs=Ae("categoryFacet/selectSearchResult",(e=>Xe(e,{facetId:Io,value:new ze({values:js}),retrieveCount:new De({min:1})}))),Is=Ae("categoryFacetSearch/register",(e=>Xe(e,Po)));function As(e,t,n){e.currentValues=function(e,t){if(!e.length)return[];const n=xs(e[0],t);let r=n;for(const n of e.splice(1)){const e=xs(n,t);r.children.push(e),r=e}return r.state="selected",r.retrieveChildren=!0,[n]}(t,n),e.numberOfValues=t.length?1:e.numberOfValues,e.preventAutoSelect=!0}function xs(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}function Cs(e){if(!e)return{parents:[],values:[]};let t=[],n=e;for(;n.length&&n[0].children.length;)t=[...t,...n],n=n[0].children;const r=n.find((e=>"selected"===e.state));return r&&(t=[...t,r],n=[]),{parents:t,values:n}}const Ms=xe({},(e=>{e.addCase(gs,((e,t)=>{const n=t.payload,{facetId:r}=n;var i;r in e||(e[r]=(i=n,{...Rs,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...i}))})).addCase(Ut.fulfilled,((e,t)=>t.payload.categoryFacetSet)).addCase(Hi,((e,t)=>{const n=t.payload.cf||{};Object.keys(e).forEach((t=>{const r=e[t];As(r,n[t]||[],r.numberOfValues)}))})).addCase(Ss,((e,t)=>{const{facetId:n,criterion:r}=t.payload,i=e[n];i&&(i.sortCriteria=r)})).addCase(bs,((e,t)=>{const{facetId:n,selection:r,retrieveCount:i}=t.payload,o=e[n];if(!o)return;let u=o.currentValues;const{path:s}=r,a=s.slice(0,s.length-1);for(const e of a){const t=u[0];if(e!==t.value)return;t.retrieveChildren=!1,t.state="idle",u=t.children}if(u.length){const e=u[0];return e.retrieveChildren=!0,e.state="selected",void(e.children=[])}const c=function(e,t){const{value:n}=e;return{value:n,state:"selected",children:[],retrieveChildren:!0,retrieveCount:t}}(r,i);u.push(c),o.numberOfValues=1})).addCase(ws,((e,t)=>{$o(e,t.payload)})).addCase(Yo,(e=>{Object.keys(e).forEach((t=>{$o(e,t)}))})).addCase(Os,((e,t)=>{const{facetId:n}=t.payload,r=e[n];if(r)return r.currentValues.length?void function(e,t){var n;const{facetId:r,numberOfValues:i}=t;let o=null===(n=e[r])||void 0===n?void 0:n.currentValues[0];if(o){for(;o.children.length&&"selected"!==(null==o?void 0:o.state);)o=o.children[0];o.retrieveCount=i}}(e,t.payload):Lo(e,t.payload)})).addCase(qs,((e,t)=>{const{facetId:n,value:r,retrieveCount:i}=t.payload,o=e[n];o&&As(o,[...r.path,r.rawValue],i)})).addCase(Zr.fulfilled,((e,t)=>{const{facets:n}=t.payload.response;n.forEach((t=>{if(!function(e,t){return t.facetId in e}(e,t))return;const n=e[t.facetId],r=function(e,t){const n=Cs(e.currentValues).parents,r=Cs(t.values).parents;return n.length!==r.length}(n,t);n.currentValues=r?[]:n.currentValues,n.preventAutoSelect=!1}))}))})),Rs={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0},Es=xe({},(e=>{e.addCase(Is,((e,t)=>{du(e,t.payload,Ts)})).addCase(Do,((e,t)=>{fu(e,t.payload)})).addCase(Pu.pending,((e,t)=>{hu(e,t.meta.arg)})).addCase(Pu.rejected,((e,t)=>{vu(e,t.meta.arg)})).addCase(Pu.fulfilled,((e,t)=>{mu(e,t.payload)}))}));function Ts(){return{moreValuesAvailable:!1,values:[]}}const ks=Ae("facetOptions/update",(e=>Xe(e,{freezeFacetOrder:new Ne({required:!1})}))),Ps=xe({freezeFacetOrder:!1},(e=>{e.addCase(ks,((e,t)=>({...e,...t.payload}))).addCase(Zr.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(Zr.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(Ut.fulfilled,((e,t)=>t.payload.facetOptions))})),Vs=Ae("advancedSearchQueries/update",(e=>Xe(e,{aq:new Ye({required:!1,emptyAllowed:!0}),cq:new Ye({required:!1,emptyAllowed:!0})}))),Fs=xe({cq:"",aq:""},(e=>{e.addCase(Vs,((e,t)=>{Ve(t.payload.aq)||(e.aq=t.payload.aq),Ve(t.payload.cq)||(e.cq=t.payload.cq)})).addCase(Ut.fulfilled,((e,t)=>t.payload.advancedSearchQueries)).addCase(Hi,((e,t)=>{var n,r;e.aq=null!==(n=t.payload.aq)&&void 0!==n?n:e.aq,e.cq=null!==(r=t.payload.cq)&&void 0!==r?r:e.cq}))})),Ds=Ae("debug/enable"),_s=Ae("debug/disable"),Ns=xe(!1,(e=>{e.addCase(Ds,(()=>!0)).addCase(_s,(()=>!1)).addCase(Hi,((e,t)=>{var n;return null!==(n=t.payload.debug)&&void 0!==n?n:e}))})),$s={configuration:Tt,facetSet:Ho,dateFacetSet:os,facetOrder:xe([],(e=>{e.addCase(Zr.fulfilled,((e,t)=>t.payload.response.facets.map((e=>e.facetId)))),e.addCase(Ut.fulfilled,((e,t)=>t.payload.facetOrder))})),numericFacetSet:hs,categoryFacetSet:Ms,facetSearchSet:Fu,facetOptions:Ps,categoryFacetSearchSet:Es,query:zi,advancedSearchQueries:Fs,querySet:to,pagination:mo,redirection:Zi,querySuggest:eo,search:uo,sortCriteria:qo,context:Bt,history:((e,t)=>{const n=$t(t);return(t=n,r)=>{switch(r.type){case _t:return(e=>{const{past:t,present:n,future:r}=e;if(0===t.length)return e;const i=t[t.length-1];return{past:t.slice(0,t.length-1),present:i,future:[n,...r]}})(t);case Nt:return(e=>{const{past:t,present:n,future:r}=e;return 0===r.length?e:{past:[...t,n],present:r[0],future:r.slice(1)}})(t);default:return((e,t,n,r)=>{const{past:i,present:o}=e,u=n(o,r);return u===t.present||o===u?e:o===t.present?$t(u):{past:[...i,o],present:u,future:[]}})(t,n,e,r)}}})(Jo,Qo()),didYouMean:lu,fields:$u,pipeline:Yu,searchHub:xr,debug:Ns};function Ls(e){let t="{}";return{subscribe(n){return n(),e.subscribe((()=>{(e=>{try{const n=JSON.stringify(e),r=t!==n;return t=n,r}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&n()}))},get state(){return{}}}}xe({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[]},(e=>{e.addCase(Rr,((e,t)=>{e.id=t.payload.id})).addCase(Er.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Er.fulfilled,((e,t)=>{e.error=null,e.recommendations=t.payload.recommendations,e.duration=t.payload.duration,e.isLoading=!1})).addCase(Er.pending,(e=>{e.isLoading=!0}))}));const Ys=e=>{const t=/^(\w+(?:\s\w+)*): ([-0-9]+)$/;if(!e)return null;const n=e.match(/(\w+(?:\s\w+)*): ([-0-9]+)/g);if(!n)return null;const r={};for(const e of n){const n=e.match(t);n&&(r[n[1]]=Number(n[2]))}return r},Hs=(e,t)=>{const n=[];let r;for(;null!==(r=t.exec(e));)n.push(r);return n},zs=e=>{const t=/([^:]+): ([0-9]+), ([0-9]+); /g;if(!e||!e[1])return null;const n=Hs(e[1],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);if(!n)return null;const r={};for(const e of n){const n=Hs(e[1],t),i={};for(const e of n)i[e[1]]={Correlation:Number(e[2]),"TF-IDF":Number(e[3])};const o=Ys(e[2]);r[Object.keys(i).join(", ")]={terms:i,Weights:o}}return r};function Us(e){return e.search.response.results.map((e=>({result:e,ranking:(e=>{if(!e)return null;const t=/Document weights:\n((?:.)*?)\n+/g.exec(e),n=/Terms weights:\n((?:.|\n)*)\n+/g.exec(e),r=/Total weight: ([0-9]+)/g.exec(e),i=(e=>{const t=/(Expression:\s".*")\sScore:\s(?!0)([0-9]+)\n+/g;let n=t.exec(e);const r=[];for(;n;)r.push({expression:n[1],score:parseInt(n[2],10)}),n=t.exec(e);return r})(e);return{documentWeights:Ys(t?t[1]:null),termsWeight:zs(n),totalWeight:r?Number(r[1]):null,qreWeights:i}})(e.rankingInfo)})))}const Bs=new ke({enabled:new Ne({default:!1})}),Qs=new ke({automaticallyLogInformation:new Ne({default:!0})});function Js(e,t={}){let n="";const r=Ls(e),{dispatch:i}=e,o=et(e,Bs,t.initialState,Js.name),u=tt(e,Qs,t.options,Js.name);let s=!1;return o.enabled&&i(Ds()),{...r,get state(){const t=e.state.debug;if(!e.state.debug)return{isEnabled:t};const{executionReport:n,basicExpression:r,advancedExpression:i,constantExpression:o,userIdentities:u,rankingExpressions:s}=e.state.search.response;return{isEnabled:t,rankingInformation:Us(e.state),executionReport:n,expressions:{basicExpression:r,advancedExpression:i,constantExpression:o},userIdentities:u,rankingExpressions:s}},enable(){i(Ds())},disable(){i(_s())},logInformation(){var t;this.state.isEnabled?e.logger.info(this.state,"Relevance inspector information for new query"):(e.logger.warn('Relevance inspector "logInformation" has been called without debug being enabled. Enabling debug and triggering a query'),s=!0,this.enable(),i(Zr((t=ar.Search,Ee("analytics/noop",(async()=>({analyticsType:t}))))())))},subscribe(t){return t(),e.subscribe((()=>{(e=>{const t=e!==n;return n=e,t})(e.state.search.response.searchUid)&&(this.state.isEnabled&&(u.automaticallyLogInformation||s)&&(s=!1,this.logInformation()),t())}))}}}const Ws=e=>{const t=Ls(e),{dispatch:n}=e;return{...t,get state(){return{values:e.state.context.contextValues}},set(e){n(Vt(e))},add(e,t){n(Ft({contextKey:e,contextValue:t}))},remove(e){n(Dt(e))}}},Zs=e=>{const t=Ls(e),{dispatch:n}=e;return n(Vr()),{...t,get state(){const t=e.state;return{wasCorrectedTo:t.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:t.didYouMean.wasAutomaticallyCorrected,queryCorrection:t.didYouMean.queryCorrection,hasQueryCorrection:""!==t.didYouMean.queryCorrection.correctedQuery||""!==t.didYouMean.wasCorrectedTo}},applyCorrection(){n(Dr(this.state.queryCorrection.correctedQuery)),n(Zr(kr()))}}},Ks=(e,t)=>e.search.response.facets.find((e=>e.facetId===t)),Gs=(e,t)=>{const n=Ks(e,t);if(function(e,t){return!!t&&t.facetId in e.facetSet}(e,n))return n},Xs=(e,t)=>{const n=Gs(e,t);return n?n.values.filter((e=>"selected"===e.state)):[]},ea=(e,t)=>{const n=Ks(e,t);if(function(e,t){return!!t&&t.facetId in e.categoryFacetSet}(e,n))return n},ta=(e,t)=>{const n=ea(e,t);return Cs(null==n?void 0:n.values).parents};function na(e,t){const n=e.dispatch,{options:r,getFacetSearch:i}=t,o=r.facetId,u=r.numberOfValues||10;return{updateText(e){n(Do({facetId:o,query:`*${e}*`,numberOfValues:u}))},showMoreResults(){const{numberOfValues:e}=i().options;n(Do({facetId:o,numberOfValues:e+u})),n(Pu(o))},search(){n(Pu(o))},select(e){const t=e.rawValue;n(ks({freezeFacetOrder:!0})),n(Zr(Tu({facetId:o,facetValue:t})))},get state(){const{response:e,isLoading:t}=i(),n=e.values;return{...e,values:n,isLoading:t}}}}const ra=Ee("categoryFacetController/executeToggleSelect",(({facetId:e,selection:t,retrieveCount:n},{dispatch:r,extra:{validatePayload:i}})=>{i(e,We),ys(t);const o=((e,t)=>{const n={facetId:e,facetValue:t.value};return"selected"===t.state?ku(n):Tu(n)})(e,t);r(bs({facetId:e,selection:t,retrieveCount:n})),r(ks({freezeFacetOrder:!0})),r(Zr(o))})),ia=Ee("categoryFacetController/executeDeselectAll",(({facetId:e,numberOfValues:t},{dispatch:n,extra:{validatePayload:r}})=>{r({facetId:e,numberOfValues:t},{facetId:Io,numberOfValues:new De({required:!0})}),n(ws(e)),n(Os({facetId:e,numberOfValues:t})),n(ks({freezeFacetOrder:!0})),n(Zr(Eu(e)))})),oa=new Ye({regex:/^[a-zA-Z0-9-_]+$/}),ua=new Ye({required:!0}),sa=new Be({each:new Ye}),aa=new Ye,ca=new Ne,la=new Ne,da=new De({min:0}),fa=new De({min:1}),ha=new Ne({required:!0}),va=new ze,ma=new Ye,ya=new ze({values:{captions:va,numberOfValues:fa,query:ma}}),pa=new ke({facetId:oa,field:ua,basePath:sa,delimitingCharacter:aa,filterByBasePath:ca,filterFacetCount:la,injectionDepth:da,numberOfValues:fa,sortCriteria:new Ye({constrainTo:["alphanumeric","occurrences"]}),facetSearch:ya});function ga(e){const{facetSet:t,numericFacetSet:n,dateFacetSet:r,categoryFacetSet:i}=e;return[t,n,r,i]}function ba(e,t){const{state:n,logger:r}=e,{field:i,facetId:o}=t;return o||function(e,t){const{field:n,state:r}=e;if(!function(e){const{field:t,state:n}=e;return ga(n).some((e=>e&&t in e))}(e))return n;const i=n+"_",o=function(e,t){return function(e,t){const n=e.map((e=>{const n=e.split(t)[1],r=parseInt(n,10);return Number.isNaN(r)?0:r})).sort().pop();return null!=n?n:0}(ga(t).map((e=>Object.keys(e||{}))).reduce(((e,t)=>e.concat(t)),[]),e)+1}(i,r);return function(e,t){t.warn(`A facet with field "${e}" already exists.\n  To avoid unexpected behaviour, configure the #id option on the facet controller.`)}(n,t),`${i}${o}`}({field:i,state:n},r)}function wa(e,t){const n=Ls(e),{dispatch:r}=e,i=ba(e,t.options),o={...Rs,...t.options,facetId:i};tt(e,pa,o,wa.name);const u=()=>((e,t)=>e.categoryFacetSet[t])(e.state,i);r(gs(o));const s=(()=>{const{facetSearch:n}=t.options,r={facetId:i,...n};return function(e,t){const{dispatch:n}=e,r={...yu,...t.options},{facetId:i}=r;n(Is(r));const o=na(e,{options:r,getFacetSearch:()=>e.state.categoryFacetSearchSet[i]});return{...o,select(e){n(qs({facetId:i,value:e,retrieveCount:r.numberOfValues})),o.select(e)},get state(){return o.state}}}(e,{options:r})})(),{state:a,...c}=s;return{...n,facetSearch:c,toggleSelect:e=>r(ra({facetId:i,selection:e,retrieveCount:o.numberOfValues})),deselectAll:()=>r(ia({facetId:i,numberOfValues:o.numberOfValues})),sortBy(e){const t=o.facetId;r(Ss({facetId:t,criterion:e})),r(ks({freezeFacetOrder:!0})),r(Zr(Ru({facetId:t,criterion:e})))},isSortedBy:e=>u().sortCriteria===e,showMoreValues(){const{facetId:e,numberOfValues:t}=o,{values:n}=this.state;r(Os({facetId:e,numberOfValues:n.length+t})),r(ks({freezeFacetOrder:!0})),r(Zr(xu(e)))},showLessValues(){const{facetId:e,numberOfValues:t}=o;r(Os({facetId:e,numberOfValues:t})),r(ks({freezeFacetOrder:!0})),r(Zr(Cu(e)))},get state(){const t=u(),n=ea(e.state,i),{parents:r,values:a}=Cs(null==n?void 0:n.values);return{facetId:i,parents:r,values:a,isLoading:e.state.search.isLoading,hasActiveValues:0!==r.length,canShowMoreValues:r.length>0?r[r.length-1].moreValuesAvailable:(null==n?void 0:n.moreValuesAvailable)||!1,canShowLessValues:a.length>o.numberOfValues,sortCriteria:t.sortCriteria,facetSearch:s.state}}}}const Oa=e=>"selected"===e.state,Sa=Ee("facet/executeToggleSelect",(({facetId:e,selection:t},{dispatch:n,extra:{validatePayload:r}})=>{const i=((e,t)=>{const n={facetId:e,facetValue:t.value};return Oa(t)?ku(n):Tu(n)})(e,t);r({facetId:e,selection:t},{facetId:Io,selection:new ze({values:Ao})}),n(Mo({facetId:e,selection:t})),n(ks({freezeFacetOrder:!0})),n(Zr(i))})),ja=new ke({facetId:oa,field:ua,delimitingCharacter:aa,filterFacetCount:la,injectionDepth:da,numberOfValues:fa,sortCriteria:new Ye({constrainTo:["score","alphanumeric","occurrences","automatic"]}),facetSearch:ya});function qa(e,t){const{dispatch:n}=e,r=Ls(e),i=ba(e,t.options),o={facetSearch:{...yu},...zo,...t.options,facetId:i};tt(e,ja,o,qa.name);const u=()=>((e,t)=>e.facetSet[t])(e.state,i),s=()=>{const{currentValues:e}=u(),t=o.numberOfValues,n=!!e.find((e=>"idle"===e.state));return t<e.length&&n};n(Co(o));const a=(()=>{const{facetId:t,facetSearch:n}=o,r={facetId:t,...n};return function(e,t){const{dispatch:n}=e,{options:r}=t,{facetId:i}=r;n(Fo(r));const o=na(e,{options:r,getFacetSearch:()=>e.state.facetSearchSet[i]});return{...o,select(e){n(_o({facetId:i,value:e})),o.select(e)},get state(){return o.state}}}(e,{options:r})})(),{state:c,...l}=a;return{...r,facetSearch:l,toggleSelect:e=>n(Sa({facetId:o.facetId,selection:e})),isValueSelected:Oa,deselectAll(){n(Ro(i)),n(ks({freezeFacetOrder:!0})),n(Zr(Eu(i)))},sortBy(e){n(Eo({facetId:i,criterion:e})),n(ks({freezeFacetOrder:!0})),n(Zr(Ru({facetId:i,criterion:e})))},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){const e=u().numberOfValues,t=o.numberOfValues;n(To({facetId:i,numberOfValues:e+(t-e%t)})),n(ko({facetId:i,isFieldExpanded:!0})),n(ks({freezeFacetOrder:!0})),n(Zr(xu(i)))},showLessValues(){const e=Math.max(o.numberOfValues,(()=>{const{currentValues:e}=u();return e.filter((e=>"idle"!==e.state)).length})());n(To({facetId:i,numberOfValues:e})),n(ko({facetId:i,isFieldExpanded:!1})),n(ks({freezeFacetOrder:!0})),n(Zr(Cu(i)))},get state(){const t=u(),n=Gs(e.state,i),r=e.state.search.isLoading,o=t.sortCriteria,c=n?n.values:[],l=c.some((e=>"idle"!==e.state));return{facetId:i,values:c,sortCriterion:o,isLoading:r,hasActiveValues:l,canShowMoreValues:!!n&&n.moreValuesAvailable,canShowLessValues:s(),facetSearch:a.state}}}}const Ia=e=>"selected"===e.state,Aa=Ee("rangeFacet/executeToggleSelect",(({facetId:e,selection:t},{dispatch:n,extra:{validatePayload:r}})=>{r({facetId:e,selection:t},{facetId:Io,selection:xa(t)});const i=((e,t)=>{const{start:n,end:r}=t,i={facetId:e,facetValue:`${n}..${r}`};return Ia(t)?ku(i):Tu(i)})(e,t);n(ks({freezeFacetOrder:!0})),n(Zr(i))})),xa=e=>new ze("string"==typeof e.start?{values:Uu}:{values:zu});function Ca(e,t){const{facetId:n,getRequest:r}=t,i=Ls(e),o=e.dispatch;return{...i,toggleSelect:e=>o(Aa({facetId:n,selection:e})),isValueSelected:Ia,deselectAll(){o(Ro(n)),o(ks({freezeFacetOrder:!0})),o(Zr(Eu(n)))},sortBy(e){o(Hu({facetId:n,criterion:e})),o(ks({freezeFacetOrder:!0})),o(Zr(Ru({facetId:n,criterion:e})))},isSortedBy(e){return this.state.sortCriterion===e},get state(){const t=r(),i=Ks(e.state,n),o=t.sortCriteria,u=i?i.values:[],s=e.state.search.isLoading,a=u.some((e=>"idle"!==e.state));return{facetId:n,values:u,sortCriterion:o,hasActiveValues:a,isLoading:s}}}}const Ma=Ee("dateFacet/executeToggleSelect",(({facetId:e,selection:t},{dispatch:n,extra:{validatePayload:r}})=>{r({facetId:e,selection:t},{facetId:Io,selection:new ze({values:Uu})}),n(Wu({facetId:e,selection:t})),n(Aa({facetId:e,selection:t}))})),Ra=["idle","selected"],Ea=["ascending","descending"],Ta={start:new Ye,end:new Ye,endInclusive:new Ne,state:new Ye({constrainTo:Ra})},ka=new ke({facetId:oa,field:ua,generateAutomaticRanges:ha,filterFacetCount:la,injectionDepth:da,numberOfValues:fa,currentValues:new Be({each:new ze({values:Ta})}),sortCriteria:new Ye({constrainTo:Ea})});var Pa=yt((function(e){e.exports=function(){var e="millisecond",t="second",n="minute",r="hour",i="day",o="week",u="month",s="quarter",a="year",c="date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,d=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},h=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},v={s:h,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+h(r,2,"0")+":"+h(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,u),o=n-i<0,s=t.clone().add(r+(o?-1:1),u);return+(-(r+(n-i)/(o?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:u,y:a,w:o,d:i,D:c,h:r,m:n,s:t,ms:e,Q:s}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},m="en",y={};y[m]=f;var p=function(e){return e instanceof O},g=function(e,t,n){var r;if(!e)return m;if("string"==typeof e)y[e]&&(r=e),t&&(y[e]=t,r=e);else{var i=e.name;y[i]=e,r=i}return!n&&r&&(m=r),r||!n&&m},b=function(e,t){if(p(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new O(n)},w=v;w.l=g,w.i=p,w.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var O=function(){function f(e){this.$L=g(e.locale,null,!0),this.parse(e)}var h=f.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(l);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return w},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(e,t){var n=b(e);return this.startOf(t)<=n&&n<=this.endOf(t)},h.isAfter=function(e,t){return b(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<b(e)},h.$g=function(e,t,n){return w.u(e)?this[t]:this.set(n,e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,s){var l=this,d=!!w.u(s)||s,f=w.p(e),h=function(e,t){var n=w.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return d?n:n.endOf(i)},v=function(e,t){return w.w(l.toDate()[e].apply(l.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},m=this.$W,y=this.$M,p=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case a:return d?h(1,0):h(31,11);case u:return d?h(1,y):h(0,y+1);case o:var b=this.$locale().weekStart||0,O=(m<b?m+7:m)-b;return h(d?p-O:p+(6-O),y);case i:case c:return v(g+"Hours",0);case r:return v(g+"Minutes",1);case n:return v(g+"Seconds",2);case t:return v(g+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(o,s){var l,d=w.p(o),f="set"+(this.$u?"UTC":""),h=(l={},l[i]=f+"Date",l[c]=f+"Date",l[u]=f+"Month",l[a]=f+"FullYear",l[r]=f+"Hours",l[n]=f+"Minutes",l[t]=f+"Seconds",l[e]=f+"Milliseconds",l)[d],v=d===i?this.$D+(s-this.$W):s;if(d===u||d===a){var m=this.clone().set(c,1);m.$d[h](v),m.init(),this.$d=m.set(c,Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](v);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[w.p(e)]()},h.add=function(e,s){var c,l=this;e=Number(e);var d=w.p(s),f=function(t){var n=b(l);return w.w(n.date(n.date()+Math.round(t*e)),l)};if(d===u)return this.set(u,this.$M+e);if(d===a)return this.set(a,this.$y+e);if(d===i)return f(1);if(d===o)return f(7);var h=(c={},c[n]=6e4,c[r]=36e5,c[t]=1e3,c)[d]||1,v=this.$d.getTime()+e*h;return w.w(v,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=w.z(this),i=this.$locale(),o=this.$H,u=this.$m,s=this.$M,a=i.weekdays,c=i.months,l=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].substr(0,o)},f=function(e){return w.s(o%12||12,e,"0")},h=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},v={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:w.s(s+1,2,"0"),MMM:l(i.monthsShort,s,c,3),MMMM:l(c,s),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,a,2),ddd:l(i.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(o),HH:w.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,u,!0),A:h(o,u,!1),m:String(u),mm:w.s(u,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:r};return n.replace(d,(function(e,t){return t||v[e]||r.replace(":","")}))},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(e,c,l){var d,f=w.p(c),h=b(e),v=6e4*(h.utcOffset()-this.utcOffset()),m=this-h,y=w.m(this,h);return y=(d={},d[a]=y/12,d[u]=y,d[s]=y/3,d[o]=(m-v)/6048e5,d[i]=(m-v)/864e5,d[r]=m/36e5,d[n]=m/6e4,d[t]=m/1e3,d)[f]||m,l?y:w.a(y)},h.daysInMonth=function(){return this.endOf(u).$D},h.$locale=function(){return y[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=g(e,t,!0);return r&&(n.$L=r),n},h.clone=function(){return w.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},f}(),S=O.prototype;return b.prototype=S,[["$ms",e],["$s",t],["$m",n],["$H",r],["$W",i],["$M",u],["$y",a],["$D",c]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),b.extend=function(e,t){return e(t,O,b),b},b.locale=g,b.isDayjs=p,b.unix=function(e){return b(1e3*e)},b.en=y[m],b.Ls=y,b.p={},b}()})),Va=yt((function(e){e.exports=function(e,t,n){var r=t.prototype;n.utc=function(e){return new t({date:e,utc:!0,args:arguments})},r.utc=function(e){var t=n(this.toDate(),{locale:this.$L,utc:!0});return e?t.add(this.utcOffset(),"minute"):t},r.local=function(){return n(this.toDate(),{locale:this.$L,utc:!1})};var i=r.parse;r.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),i.call(this,e)};var o=r.init;r.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else o.call(this)};var u=r.utcOffset;r.utcOffset=function(e,t){var n=this.$utils().u;if(n(e))return this.$u?0:n(this.$offset)?u.call(this):this.$offset;var r=Math.abs(e)<=16?60*e:e,i=this;if(t)return i.$offset=r,i.$u=0===e,i;if(0!==e){var o=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(i=this.local().add(r+o,"minute")).$offset=r,i.$x.$localOffset=o}else i=this.utc();return i};var s=r.format;r.format=function(e){return s.call(this,e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":""))},r.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},r.isUTC=function(){return!!this.$u},r.toISOString=function(){return this.toDate().toISOString()},r.toString=function(){return this.toDate().toUTCString()};var a=r.toDate;r.toDate=function(e){return"s"===e&&this.$offset?n(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():a.call(this)};var c=r.diff;r.diff=function(e,t,r){if(this.$u===e.$u)return c.call(this,e,t,r);var i=this.local(),o=n(e).local();return c.call(i,o,t,r)}}})),Fa=yt((function(e){e.exports=function(){var e,t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=function(e,n){return e.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(e,r,i){var o=i&&i.toUpperCase();return r||n[i]||t[i]||n[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))},r=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d\d/,o=/\d\d?/,u=/\d*[^\s\d-:/()]+/,s=function(e){return function(t){this[e]=+t}},a=[/[+-]\d\d:?\d\d/,function(e){var t,n;(this.zone||(this.zone={})).offset=0==(n=60*(t=e.match(/([+-]|\d\d)/g))[1]+ +t[2])?0:"+"===t[0]?-n:n}],c=function(t){var n=e[t];return n&&(n.indexOf?n:n.s.concat(n.f))},l=function(t,n){var r,i=e.meridiem;if(i){for(var o=1;o<=24;o+=1)if(t.indexOf(i(o,0,n))>-1){r=o>12;break}}else r=t===(n?"pm":"PM");return r},d={A:[u,function(e){this.afternoon=l(e,!1)}],a:[u,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[i,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[o,s("seconds")],ss:[o,s("seconds")],m:[o,s("minutes")],mm:[o,s("minutes")],H:[o,s("hours")],h:[o,s("hours")],HH:[o,s("hours")],hh:[o,s("hours")],D:[o,s("day")],DD:[i,s("day")],Do:[u,function(t){var n=e.ordinal,r=t.match(/\d+/);if(this.day=r[0],n)for(var i=1;i<=31;i+=1)n(i).replace(/\[|\]/g,"")===t&&(this.day=i)}],M:[o,s("month")],MM:[i,s("month")],MMM:[u,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[u,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,s("year")],YY:[i,function(e){this.year=(e=+e)+(e>68?1900:2e3)}],YYYY:[/\d{4}/,s("year")],Z:a,ZZ:a},f=function(t,i,o){try{var u=function(t){for(var i=(t=n(t,e&&e.formats)).match(r),o=i.length,u=0;u<o;u+=1){var s=i[u],a=d[s],c=a&&a[1];i[u]=c?{regex:a&&a[0],parser:c}:s.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<o;n+=1){var u=i[n];if("string"==typeof u)r+=u.length;else{var s=u.regex,a=u.parser,c=e.substr(r),l=s.exec(c)[0];a.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}(i)(t),s=u.year,a=u.month,c=u.day,l=u.hours,f=u.minutes,h=u.seconds,v=u.milliseconds,m=u.zone,y=new Date,p=c||(s||a?1:y.getDate()),g=s||y.getFullYear(),b=0;s&&!a||(b=a>0?a-1:y.getMonth());var w=l||0,O=f||0,S=h||0,j=v||0;return m?new Date(Date.UTC(g,b,p,w,O,S,j+60*m.offset*1e3)):o?new Date(Date.UTC(g,b,p,w,O,S,j)):new Date(g,b,p,w,O,S,j)}catch(e){return new Date("")}};return function(t,n,r){r.p.customParseFormat=!0;var i=n.prototype,o=i.parse;i.parse=function(t){var n=t.date,i=t.utc,u=t.args;this.$u=i;var s=u[1];if("string"==typeof s){var a=!0===u[2],c=!0===u[3],l=a||c,d=u[2];c&&(d=u[2]),a||(e=d?r.Ls[d]:this.$locale()),this.$d=f(n,s,i),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),l&&n!==this.format(s)&&(this.$d=new Date("")),e=void 0}else if(s instanceof Array)for(var h=s.length,v=1;v<=h;v+=1){u[1]=s[v-1];var m=r.apply(this,u);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}v===h&&(this.$d=new Date(""))}else o.call(this,t)}}}()}));function Da(e){return Na(Pa(e))===e}function _a(e,t){const{dateFormat:n,useLocalTime:r}=t,i=Pa(e,n);if(!i.isValid())throw new Error(`Could not parse the provided date "${e}".\n      Please provide a dateFormat string in the configuration options.\n      See https://day.js.org/docs/en/parse/string-format for more information.\n       `);return Na(r?i:i.utc())}function Na(e){return e.format("YYYY/MM/DD@HH:mm:ss")}function $a(e,t){const n=e.dispatch,r=ba(e,t.options),i={...t.options,facetId:r};tt(e,ka,i,$a.name),n(Ju(i));const o=Ca(e,{facetId:r,getRequest:()=>e.state.dateFacetSet[r]});return{...o,toggleSelect:e=>n(Ma({facetId:r,selection:e})),get state(){return{...o.state,isLoading:e.state.search.isLoading}}}}Pa.extend(Va),Pa.extend(Fa);const La=Ee("numericFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:n}})=>{n(e,{facetId:Io,selection:new ze({values:zu})}),t(ls(e)),t(Aa(e))})),Ya={start:new De,end:new De,endInclusive:new Ne,state:new Ye({constrainTo:Ra})},Ha=new ke({facetId:oa,field:ua,generateAutomaticRanges:ha,filterFacetCount:la,injectionDepth:da,numberOfValues:fa,currentValues:new Be({each:new ze({values:Ya})}),sortCriteria:new Ye({constrainTo:Ea})});function za(e){return{endInclusive:!1,state:"idle",...e}}function Ua(e,t){const n=e.dispatch,r=ba(e,t.options),i={...t.options,facetId:r};tt(e,Ha,i,Ua.name),n(cs(i));const o=Ca(e,{facetId:r,getRequest:()=>e.state.numericFacetSet[r]});return{...o,toggleSelect:e=>n(La({facetId:r,selection:e})),get state(){return o.state}}}const Ba=cr("history/analytics/forward",ar.Search,(e=>e.logSearchEvent("historyForward"))),Qa=cr("history/analytics/backward",ar.Search,(e=>e.logSearchEvent("historyBackward"))),Ja=e=>{const t=Ls(e),{dispatch:n}=e;return{...t,get state(){return e.state.history},async back(){await n(Ht()),n(Zr(Qa()))},async forward(){await n(zt()),n(Zr(Ba()))}}};function Wa(e){return e.pagination.numberOfResults}const Za=ve((function(e){return e.pagination.firstResult}),Wa,go),Ka=ve((function(e){return e.pagination.totalCountFiltered}),Wa,bo),Ga=ve(Za,Ka,((e,t)=>t),((e,t,n)=>{let r=function(e,t){const n=t%2==0,r=Math.floor(t/2);return{start:e-r,end:e+(n?r-1:r)}}(e,n);return r=function(e){const t=Math.max(1-e.start,0);return{start:e.start+t,end:e.end+t}}(r),r=function(e,t){const n=Math.max(e.end-t,0);return{start:Math.max(e.start-n,1),end:e.end-n}}(r,t),function(e){const t=[];for(let n=e.start;n<=e.end;++n)t.push(n);return t}(r)})),Xa=cr("analytics/pager/resize",ar.Search,((e,t)=>{var n;return e.logPagerResize({currentResultsPerPage:(null===(n=t.pagination)||void 0===n?void 0:n.numberOfResults)||10})})),ec=cr("analytics/pager/number",ar.Search,((e,t)=>e.logPagerNumber({pagerNumber:Za(t)}))),tc=cr("analytics/pager/next",ar.Search,((e,t)=>e.logPagerNext({pagerNumber:Za(t)}))),nc=cr("analytics/pager/previous",ar.Search,((e,t)=>e.logPagerPrevious({pagerNumber:Za(t)}))),rc=new ke({numberOfPages:new De({default:5,min:0})}),ic=new ke({page:new De({min:1})});function oc(e,t={}){const n=Ls(e),{dispatch:r}=e,i=tt(e,rc,t.options,oc.name),o=et(e,ic,t.initialState,oc.name).page;o&&r(lo(o));const u=()=>{const{numberOfPages:t}=i;return Ga(e.state,t)};return{...n,get state(){const t=Za(e.state),n=Ka(e.state),r=t>1&&n>0,i=t<n;return{currentPage:t,currentPages:u(),maxPage:n,hasPreviousPage:r,hasNextPage:i}},selectPage(e){r(fo(e)),r(Zr(ec()))},nextPage(){r(ho()),r(Zr(tc()))},previousPage(){r(vo()),r(Zr(nc()))},isCurrentPage(e){return e===this.state.currentPage}}}const uc=e=>({...Ls(e),get state(){return{hasError:null!==e.state.search.error,error:e.state.search.error}}}),sc=e=>({...Ls(e),get state(){const t=e.state;return{firstResult:t.pagination.firstResult+1,lastResult:t.pagination.firstResult+t.search.results.length,total:t.pagination.totalCountFiltered,query:t.search.queryExecuted,hasQuery:""!==t.search.queryExecuted,hasDuration:0!==t.search.duration,hasResults:0!==t.search.results.length,durationInMilliseconds:t.search.duration,durationInSeconds:Math.round(100*(e.state.search.duration/1e3+Number.EPSILON))/100}}}),ac=new ke({fieldsToInclude:new Be({required:!1,each:new Ye({required:!0,emptyAllowed:!1})})});function cc(e,t){const n=Ls(e),{dispatch:r}=e,i=tt(e,ac,null==t?void 0:t.options,cc.name);i.fieldsToInclude&&r(Nu(i.fieldsToInclude));let o=0,u=0,s=!1;return{...n,get state(){const t=e.state;return{results:t.search.results,isLoading:t.search.isLoading}},fetchMoreResults:()=>{if(!e.state.search.isLoading){if(Date.now()-o<200){if(u++,u>=5)return o=Date.now(),!s&&e.logger.error('The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively 5 times, with little delay. Please verify the conditions under which the function is called.'),void(s=!0)}else u=0;s=!1,r(Kr()).then((()=>o=Date.now()))}}}}const lc=new ke({numberOfResults:new De({min:0})});function dc(e,t={}){const n=Ls(e),{dispatch:r}=e,i=et(e,lc,t.initialState,dc.name).numberOfResults;return void 0!==i&&r(ao(i)),{...n,get state(){return{numberOfResults:e.state.pagination.numberOfResults}},set(e){r(co(e)),r(Zr(Xa()))},isSetTo(e){return e===this.state.numberOfResults}}}const fc=cr("analytics/searchbox/submit",ar.Search,(e=>e.logSearchboxSubmit())),hc={enableQuerySyntax:!1,numberOfSuggestions:5},vc={open:new Ye,close:new Ye},mc={id:We,numberOfSuggestions:new De({min:0}),enableQuerySyntax:new Ne,highlightOptions:new ze({values:{notMatchDelimiters:new ze({values:vc}),exactMatchDelimiters:new ze({values:vc}),correctionDelimiters:new ze({values:vc})}})},yc=new ke(mc),pc=({id:e,suggestion:t})=>cr("analytics/querySuggest",ar.Search,((n,r)=>{const i=r.querySuggest&&r.querySuggest[e];if(null!=i){const e=i.completions.map((e=>e.expression)),r={suggestionRanking:e.indexOf(t),partialQuery:i.q,partialQueries:i.partialQueries,suggestions:e};return n.logOmniboxAnalytics(r)}}))();function gc(e){return""===e}function bc(e,t){return(e=Oc(e)).replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,((e,n,r,i)=>n?wc(n,t.notMatchDelimiters):r?wc(r,t.exactMatchDelimiters):i?wc(i,t.correctionDelimiters):e))}function wc(e,t){return t?t.open+e+t.close:e}function Oc(e){return e.replace(/&/g,"&amp").replace(/</g,"&lt").replace(/>/g,"&gt").replace(/"/g,"&quot").replace(/`/g,"&#96").replace(/'/g,"&#x27")}function Sc(e,t={}){var n,r;const i=Ls(e),{dispatch:o}=e,u=(null===(n=t.options)||void 0===n?void 0:n.id)||((e,t=5)=>"search_box"+Math.random().toString(36).substr(2,2+t))(),s={id:u,highlightOptions:{...null===(r=t.options)||void 0===r?void 0:r.highlightOptions},...hc,...t.options};tt(e,yc,s,Sc.name),o(Gi({id:u,query:""})),o(Vi({id:u,q:e.state.query.q,count:s.numberOfSuggestions}));const a=()=>e.state.querySet[s.id],c=e=>{const{enableQuerySyntax:t}=s;o(_r({q:a(),enableQuerySyntax:t})),o(fo(1)),o(Zr(e))};return{...i,updateText(e){o(Xi({id:u,query:e})),this.showSuggestions()},clear(){o(Xi({id:u,query:""})),o(_i({id:u}))},hideSuggestions(){o(Ni({id:u}))},showSuggestions(){s.numberOfSuggestions&&o($i({id:u}))},selectSuggestion(e){o(Di({id:u,expression:e})),c(pc({id:u,suggestion:e}))},submit(){c(fc())},get state(){const t=e.state,n=function(e,t){return e?e.completions.map((e=>({highlightedValue:bc(e.highlighted,t),rawValue:e.expression}))):[]}(t.querySuggest[s.id],s.highlightOptions);return{value:a(),suggestions:n,isLoading:t.search.isLoading}}}}Object.freeze({__proto__:null,highlightString:function(e){if(gc(e.openingDelimiter)||gc(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(Fe(e.content)||gc(e.content))return e.content;const t=e.content.length;let n="",r=0;for(let i=0;i<e.highlights.length;i++){const o=e.highlights[i],u=o.offset,s=u+o.length;if(s>t)break;n+=e.content.slice(r,u),n+=e.openingDelimiter,n+=e.content.slice(u,s),n+=e.closingDelimiter,r=s}return r!==t&&(n+=e.content.slice(r)),n},getHighlightedSuggestion:bc,escape:Oc});const jc=cr("analytics/sort/results",ar.Search,((e,t)=>e.logResultsSort({resultsSortBy:t.sortCriteria||Ur()}))),qc=new ze({values:{by:new Je({enum:$r,required:!0}),order:new Je({enum:Nr}),field:new Ye}});function Ic(e,t={}){var n;const r=Ls(e),{dispatch:i}=e;!function(e,t){if(!t)return;const n=new ke({criterion:new Be({each:qc})}),r=function(e){return e.criterion?Qe(e.criterion)?e.criterion:[e.criterion]:[]}(t),i={...t,criterion:r};et(e,n,i,Ic.name)}(e,t.initialState);const o=null===(n=t.initialState)||void 0===n?void 0:n.criterion;return o&&i(Oo(o)),{...r,sortBy(e){i(So(e)),i(fo(1)),i(Zr(jc()))},isSortedBy(e){return this.state.sortCriteria===Lr(e)},get state(){return{sortCriteria:e.state.sortCriteria}}}}const Ac=e=>Xe(e,{evt:We,type:new Ye({required:!1,emptyAllowed:!1})}),xc=e=>cr("analytics/generic/search",ar.Search,(t=>{Ac(e);const{evt:n,meta:r}=e;return t.logSearchEvent(n,r)}))(),Cc=e=>cr("analytics/generic/click",ar.Click,((t,n)=>(mr(e.result),Ac(e),t.logClickEvent(e.evt,lr(e.result,n),dr(e.result)))))(),Mc=e=>cr("analytics/generic/custom",ar.Custom,(t=>(Ac(e),t.logCustomEventWithType(e.evt,e.type,e.meta))))(),Rc=cr("analytics/interface/load",ar.Search,(e=>e.logInterfaceLoad())),Ec=cr("analytics/interface/change",ar.Search,((e,t)=>{var n;return e.logInterfaceChange({interfaceChangeTo:(null===(n=t.advancedSearchQueries)||void 0===n?void 0:n.cq)||""})})),Tc=new ke({expression:new Ye}),kc=new ke({isActive:new Ne});function Pc(e,t){const n=Ls(e),{dispatch:r}=e,i=tt(e,Tc,t.options,Pc.name);return et(e,kc,t.initialState,Pc.name).isActive&&r(Vs({cq:i.expression})),{...n,select(){r(Vs({cq:i.expression})),r(Zr(Ec()))},get state(){return{isActive:e.state.advancedSearchQueries.cq===i.expression}}}}function Vc(e){return{...Ls(e),sort(e){return Jr(e,this.state.facetIds)},get state(){return{facetIds:e.state.search.response.facets.map((e=>e.facetId))}}}}const Fc=(e,t)=>{const n=((e,t)=>{const n=Ks(e,t);if(function(e,t){return!!t&&t.facetId in e.numericFacetSet}(e,n))return n})(e,t);return n?n.values.filter((e=>"selected"===e.state)):[]},Dc=(e,t)=>{const n=((e,t)=>{const n=Ks(e,t);if(function(e,t){return!!t&&t.facetId in e.dateFacetSet}(e,n))return n})(e,t);return n?n.values.filter((e=>"selected"===e.state)):[]},_c=()=>cr("analytics/facet/deselectAllFacets",ar.Search,(e=>e.logBreadcrumbResetAll()))(),Nc=e=>{const t=Ls(e),{dispatch:n}=e;function r(t,r,i){return Object.keys(t).map((o=>{const u=i(e.state,o).map((e=>({value:e,deselect:()=>n(r({facetId:o,selection:e}))})));return{field:t[o].field,values:u}})).filter((e=>e.values.length))}function i(){return r(e.state.facetSet,Sa,Xs)}function o(){return r(e.state.numericFacetSet,La,Fc)}function u(){return r(e.state.dateFacetSet,Ma,Dc)}function s(){return Object.keys(e.state.categoryFacetSet).map((t=>({field:e.state.categoryFacetSet[t].field,path:ta(e.state,t),deselect:()=>{n(ia({facetId:t,numberOfValues:5}))}}))).filter((e=>e.path.length))}return{...t,get state(){return{facetBreadcrumbs:i(),categoryFacetBreadcrumbs:s(),numericFacetBreadcrumbs:o(),dateFacetBreadcrumbs:u(),hasBreadcrumbs:!![...i(),...o(),...u(),...s()].length}},deselectAll:()=>{n(Yo()),n(Zr(_c()))}}},$c={skus:new Be({required:!1,each:new Ye({emptyAllowed:!1})}),maxNumberOfRecommendations:new De({required:!1,max:50,min:1,default:5})},Lc=new ke({id:new Ye({required:!0,emptyAllowed:!1}),...$c}),Yc=(e,t={})=>{const n=Ls(e),{dispatch:r}=e,i=tt(e,Lc,t.options,Yc.name);return r(pr({id:i.id})),r(Or({number:i.maxNumberOfRecommendations})),i.skus&&r(gr({skus:i.skus})),{...n,setSkus(e){r(gr({skus:e}))},refresh(){r(Sr())},get state(){const{skus:t,maxNumberOfRecommendations:n,recommendations:r,error:i,isLoading:o}=e.state.productRecommendations;return{skus:t,maxNumberOfRecommendations:n,recommendations:r,error:i,isLoading:o}}}},Hc=new ke({sku:new Ye({required:!0,emptyAllowed:!1}),maxNumberOfRecommendations:$c.maxNumberOfRecommendations}),zc=(e,t)=>{const n=tt(e,Hc,t.options,zc.name),r=Yc(e,{...t,options:{maxNumberOfRecommendations:n.maxNumberOfRecommendations,skus:[n.sku],id:"frequentBought"}}),{setSkus:i,...o}=r;return{...o,setSku(e){i([e])},get state(){const{skus:e,...t}=r.state;return{...t,sku:e[0]}}}},Uc=new ke({parameters:new ze({options:{required:!0},values:Yi})});function Bc(e,t){const{dispatch:n}=e,r=Ls(e);return et(e,Uc,t.initialState,Bc.name),n(Hi(t.initialState.parameters)),{...r,get state(){const t=e.state;return{parameters:{...Qc(t),...Jc(t),...Wc(t),...Zc(t),...Kc(t),...Gc(t),...Xc(t),...el(t),...tl(t),...nl(t),...rl(t),...ol(t)}}}}}function Qc(e){if(void 0===e.query)return{};const t=e.query.q;return""!==t?{q:t}:{}}function Jc(e){if(void 0===e.query)return{};const t=e.query.enableQuerySyntax;return!1!==t?{enableQuerySyntax:t}:{}}function Wc(e){if(void 0===e.advancedSearchQueries)return{};const t=e.advancedSearchQueries.aq;return""!==t?{aq:t}:{}}function Zc(e){if(void 0===e.advancedSearchQueries)return{};const t=e.advancedSearchQueries.cq;return""!==t?{cq:t}:{}}function Kc(e){if(void 0===e.pagination)return{};const t=e.pagination.firstResult;return 0!==t?{firstResult:t}:{}}function Gc(e){if(void 0===e.pagination)return{};const t=e.pagination.numberOfResults;return 10!==t?{numberOfResults:t}:{}}function Xc(e){if(void 0===e.sortCriteria)return{};const t=e.sortCriteria;return t!==Ur()?{sortCriteria:t}:{}}function el(e){if(void 0===e.facetSet)return{};const t=Object.entries(e.facetSet).map((([e,t])=>{const n=t.currentValues.filter((e=>"selected"===e.state)).map((e=>e.value));return n.length?{[e]:n}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{f:t}:{}}function tl(e){if(void 0===e.categoryFacetSet)return{};const t=Object.entries(e.categoryFacetSet).map((([e,t])=>{const{parents:n}=Cs(t.currentValues),r=n.map((e=>e.value));return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{cf:t}:{}}function nl(e){if(void 0===e.numericFacetSet)return{};const t=Object.entries(e.numericFacetSet).map((([e,t])=>{const n=il(t.currentValues);return n.length?{[e]:n}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{nf:t}:{}}function rl(e){if(void 0===e.dateFacetSet)return{};const t=Object.entries(e.dateFacetSet).map((([e,t])=>{const n=il(t.currentValues);return n.length?{[e]:n}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{df:t}:{}}function il(e){return e.filter((e=>"selected"===e.state))}function ol(e){if(void 0===e.debug)return{};const t=e.debug;return!1!==t?{debug:t}:{}}const ul=new ke({priority:new De({required:!1,default:0,min:0}),fields:new Be({required:!1,each:new Ye({required:!0,emptyAllowed:!1})})});function sl(e){const t=[];return{registerTemplates(...n){const r=[];try{(e=>{e.forEach((e=>{if(ul.validate(e,"Check the arguments of registerTemplates"),!e.conditions.every((e=>e instanceof Function)))throw new Te("Each result template conditions should be a function that takes a result as an argument and returns a boolean")}))})(n)}catch(t){return void e.logger.error(t,"Result template manager error")}n.forEach((e=>{const n={...e,priority:e.priority||0,fields:e.fields||[]};t.push(n),r.push(...n.fields)})),t.sort(((e,t)=>t.priority-e.priority)),r.length&&e.dispatch(Nu(r))},selectTemplate(e){const n=t.find((t=>t.conditions.every((t=>t(e)))));return n?n.content:null}}}const al=(e,t)=>t in e?e[t]:t in e.raw?e.raw[t]:null,cl=e=>t=>e.every((e=>void 0!==t.raw[e])),ll=e=>t=>e.every((e=>void 0===t.raw[e])),dl=(e,t)=>n=>{const r=hl(e,n);return t.some((e=>r.some((t=>(""+t).toLowerCase()===e.toLowerCase()))))},fl=(e,t)=>n=>{const r=hl(e,n);return t.every((e=>r.every((t=>(""+t).toLowerCase()!==e.toLowerCase()))))},hl=(e,t)=>{const n=t.raw[e];return Array.isArray(n)?n:[n]};var vl,ml,yl,pl,gl,bl,wl,Ol,Sl,jl,ql,Il,Al,xl,Cl,Ml,Rl,El,Tl,kl,Pl;(vl||(vl={})).updateAdvancedSearchQueries=Vs,function(e){e.registerCategoryFacet=gs,e.toggleSelectCategoryFacetValue=bs,e.deselectAllCategoryFacetValues=ws,e.updateCategoryFacetNumberOfValues=Os,e.updateCategoryFacetSortCriterion=Ss}(ml||(ml={})),function(e){e.updateBasicConfiguration=ot,e.updateSearchConfiguration=ut,e.updateAnalyticsConfiguration=st,e.renewAccessToken=at,e.disableAnalytics=ct,e.enableAnalytics=lt,e.setOriginLevel2=dt,e.setOriginLevel3=ft}(yl||(yl={})),function(e){e.setContext=Vt,e.addContext=Ft,e.removeContext=Dt}(pl||(pl={})),function(e){e.registerDateFacet=Ju,e.toggleSelectDateFacetValue=Wu,e.updateDateFacetSortCriterion=Zu,e.deselectAllDateFacetValues=Ku}(gl||(gl={})),function(e){e.enableDidYouMean=Vr,e.applyDidYouMeanCorrection=Dr,e.disableDidYouMean=Fr}(bl||(bl={})),(wl||(wl={})).registerFieldsToInclude=Nu,function(e){e.snapshot=Yt,e.back=Ht,e.change=Ut,e.forward=zt}(Ol||(Ol={})),function(e){e.registerNumericFacet=cs,e.deselectAllNumericFacetValues=fs,e.toggleSelectNumericFacetValue=ls,e.updateNumericFacetSortCriterion=ds}(Sl||(Sl={})),function(e){e.registerNumberOfResults=ao,e.registerPage=lo,e.nextPage=ho,e.previousPage=vo,e.updateNumberOfResults=co,e.updatePage=fo}(jl||(jl={})),(ql||(ql={})).setPipeline=Lu,(Il||(Il={})).updateQuery=_r,function(e){e.registerQuerySetQuery=Gi,e.updateQuerySetQuery=Xi}(Al||(Al={})),function(e){e.registerQuerySuggest=Vi,e.buildQuerySuggestRequest=Li,e.clearQuerySuggest=_i,e.clearQuerySuggestCompletions=Ni,e.fetchQuerySuggestions=$i,e.selectQuerySuggestion=Di,e.unregisterQuerySuggest=Fi}(xl||(xl={})),function(e){e.checkForRedirection=Ji,e.buildPlanRequest=Wi}(Cl||(Cl={})),function(e){e.executeSearch=Zr,e.buildSearchRequest=ti,e.fetchMoreResults=Kr}(Ml||(Ml={})),(Rl||(Rl={})).setSearchHub=Ar,function(e){e.registerSortCriterion=Oo,e.updateSortCriterion=So}(El||(El={})),function(e){e.buildRecommendationRequest=Tr,e.getRecommendations=Er,e.setRecommendationId=Rr}(Tl||(Tl={})),function(e){e.setProductRecommendationsBrandFilter=br,e.buildProductRecommendationsRequest=qr,e.getProductRecommendations=Sr,e.setProductRecommendationsCategoryFilter=wr,e.setProductRecommendationsMaxNumberOfRecommendations=Or,e.setProductRecommendationsRecommenderId=pr,e.setProductRecommendationsSkus=gr}(kl||(kl={})),function(e){e.getResultProperty=al,e.fieldsMustBeDefined=cl,e.fieldsMustNotBeDefined=ll,e.fieldMustMatch=dl,e.fieldMustNotMatch=fl}(Pl||(Pl={}));var Vl,Fl,Dl,_l,Nl,$l,Ll,Yl,Hl,zl,Ul,Bl,Ql,Jl;function Wl(e={}){return{configuration:Et(),advancedSearchQueries:{cq:"",aq:""},facetSet:{},dateFacetSet:{},numericFacetSet:{},categoryFacetSet:{},facetSearchSet:{},categoryFacetSearchSet:{},facetOptions:{freezeFacetOrder:!1},pagination:{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:{q:"",enableQuerySyntax:!1},querySet:{},querySuggest:{},redirection:{redirectTo:null},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[]},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},sortCriteria:Ur(),context:{contextValues:{}},didYouMean:{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[]}},fields:{fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},history:$t(Qo()),pipeline:"default",facetOrder:[],searchHub:"default",debug:!1,...e}}!function(e){e.logInterfaceLoad=Rc,e.logInterfaceChange=Ec,e.logClickEvent=Cc,e.logCustomEvent=Mc,e.logSearchEvent=xc}(Vl||(Vl={})),function(e){e.logDidYouMeanClick=kr,e.logDidYouMeanAutomatic=Pr}(Fl||(Fl={})),function(e){e.logFacetShowMore=xu,e.logFacetShowLess=Cu,e.logFacetSelect=Tu,e.logFacetDeselect=ku,e.logFacetClearAll=Eu,e.logFacetSearch=Mu,e.logFacetUpdateSort=Ru}(Dl||(Dl={})),(_l||(_l={})).logClearBreadcrumbs=_c,function(e){e.logNavigateForward=Ba,e.logNavigateBackward=Qa}(Nl||(Nl={})),function(e){e.logPageNext=tc,e.logPagePrevious=nc,e.logPageNumber=ec,e.logPagerResize=Xa}($l||($l={})),(Ll||(Ll={})).logProductRecommendations=yr,(Yl||(Yl={})).logSearchboxSubmit=fc,(Hl||(Hl={})).logQuerySuggestionClick=pc,(zl||(zl={})).logRecommendationUpdate=Mr,(Ul||(Ul={})).logTriggerRedirect=Qi,(Bl||(Bl={})).logDocumentOpen=e=>cr("analytics/result/open",ar.Click,((t,n)=>(mr(e),t.logDocumentOpen(lr(e,n),dr(e)))))(),(Ql||(Ql={})).logResultsSort=jc,function(e){e.logFetchMoreResults=Br,e.logQueryError=Qr}(Jl||(Jl={}));var Zl,Kl,Gl=Object.prototype,Xl=Function.prototype.toString,ed=Gl.hasOwnProperty,td=Xl.call(Object),nd=Gl.toString,rd=(Zl=Object.getPrototypeOf,Kl=Object,function(e){return Zl(Kl(e))}),id=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=nd.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=rd(e);if(null===t)return!0;var n=ed.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Xl.call(n)==td},od=mt(yt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function n(){var e=[],n=[];return{getState:function(){return o(t)?t(e):t},getActions:function(){return e},dispatch:function(t){if(!(0,r.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant? Action: '+JSON.stringify(t));e.push(t);for(var i=0;i<n.length;i++)n[i]();return t},clearActions:function(){e=[]},subscribe:function(e){return o(e)&&n.push(e),function(){var t=n.indexOf(e);t<0||n.splice(t,1)}},replaceReducer:function(e){if(!o(e))throw new Error("Expected the nextReducer to be a function.")}}}var u=le.applyMiddleware.apply(void 0,i(e))(n);return u()}};var n,r=(n=id)&&n.__esModule?n:{default:n};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=function(e){return"function"==typeof e}})));function ud(e={}){return{configuration:Et(),advancedSearchQueries:{cq:"",aq:""},context:{contextValues:{}},fields:{fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},searchHub:"default",pipeline:"default",recommendation:{duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[]},debug:!1,...e}}function sd(e={}){return{configuration:Et(),context:{contextValues:{}},searchHub:"default",productRecommendations:{id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},...e}}const ad=async()=>"";function cd(e={},t){const n=vi({level:"silent"}),r=ld(n)(e.state||t()),i=()=>{};return{mockStore:r,store:r,state:t(),subscribe:jest.fn((()=>i)),get dispatch(){return r.dispatch},get actions(){return r.getActions()},findAsyncAction(e){const t=this.actions.find((t=>t.type===e.type));return function(e){return!!e&&"meta"in e}(t)?t:void 0},...e,renewAccessToken:ad,logger:n}}const ld=e=>od([li(e),ci,ye.withExtraArgument({searchAPIClient:new Kt({logger:e,renewAccessToken:ad,preprocessRequest:Ct,postprocessSearchResponseMiddleware:Ri,postprocessQuerySuggestResponseMiddleware:Ti,postprocessFacetSearchResponseMiddleware:Ei}),validatePayload:Ge,logger:e}),...Ie(),di(e)]);function dd(e={}){return{urihash:"",parents:"",sfid:"",sfparentid:"",sfinsertedbyid:"",documenttype:"",sfcreatedbyid:"",permanentid:"",date:0,objecttype:"",sourcetype:"",sftitle:"",size:0,sffeeditemid:"",clickableuri:"",sfcreatedby:"",source:"",collection:"",connectortype:"",filetype:"",sfcreatedbyname:"",sflikecount:0,language:[],...e}}function fd(){return{serialize:hd,deserialize:pd}}function hd(e){return Object.entries(e).map(vd).filter((e=>e)).join("&")}function vd(e){const[t,n]=e;return wd(t)?"f"===t||"cf"===t?function(e){return!!md(e)&&yd(e,(e=>"string"==typeof e))}(n)?function(e,t){return Object.entries(t).map((([t,n])=>`${e}[${t}]=${n.join(",")}`)).join("&")}(t,n):"":"nf"===t||"df"===t?function(e){return!!md(e)&&yd(e,(e=>md(e)&&"start"in e&&"end"in e))}(n)?function(e,t){return Object.entries(t).map((([t,n])=>{const r=n.map((({start:e,end:t})=>`${e}..${t}`)).join(",");return`${e}[${t}]=${r}`})).join("&")}(t,n):"":`${t}=${n}`:""}function md(e){return!(!e||"object"!=typeof e)}function yd(e,t){return 0===Object.entries(e).filter((e=>{const n=e[1];return!Array.isArray(n)||!n.every(t)})).length}function pd(e){return e.split("&").map((e=>function(e){const[t,...n]=e.split("=");return[t,n.join("=")]}(e))).map(gd).filter(bd).map(Od).reduce(((e,t)=>{const[n,r]=t;if("f"===n||"cf"===n||"nf"===n||"df"===n){const t={...e[n],...r};return{...e,[n]:t}}return{...e,[n]:r}}),{})}function gd(e){const[t,n]=e,r=/^(f|cf|nf|df)\[(.+)\]$/.exec(t);if(!r)return e;const i=r[1],o={[r[2]]:function(e,t){return"nf"===e?t.map((e=>e.split("..").map(parseFloat))).filter((e=>2===e.length&&e.every(Number.isFinite))).map((([e,t])=>za({start:e,end:t,state:"selected"}))):"df"===e?function(e){return e.map((e=>e.split(".."))).filter((e=>2===e.length&&e.every(Da))).map((([e,t])=>function(e){var t,n;return{start:_a(e.start,e),end:_a(e.end,e),endInclusive:null!==(t=e.endInclusive)&&void 0!==t&&t,state:null!==(n=e.state)&&void 0!==n?n:"idle"}}({start:e,end:t,useLocalTime:!0,state:"selected"})))}(t):t}(i,n.split(","))};return[i,JSON.stringify(o)]}function bd(e){return wd(e[0])&&2===e.length}function wd(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,f:!0,cf:!0,nf:!0,df:!0,debug:!0}}function Od(e){const[t,n]=e;return"enableQuerySyntax"===t||"debug"===t?[t,"true"===n]:"firstResult"===t||"numberOfResults"===t?[t,parseInt(n)]:"f"===t||"cf"===t||"nf"===t||"df"===t?[t,JSON.parse(n)]:e}Object.freeze({__proto__:null,buildMockSearchAppEngine:function(e={}){return cd(e,Wl)},buildMockRecommendationAppEngine:function(e={}){return cd(e,ud)},buildMockProductRecommendationsAppEngine:function(e={}){return cd(e,sd)},createMockState:Wl,buildMockResult:function(e={}){return{title:"",uri:"",printableUri:"",clickUri:"",uniqueId:"",excerpt:"",firstSentences:"",summary:null,flags:"",hasHtmlVersion:!1,score:0,percentScore:0,rankingInfo:null,isTopResult:!1,isRecommendation:!1,titleHighlights:[],firstSentencesHighlights:[],excerptHighlights:[],printableUriHighlights:[],summaryHighlights:[],absentTerms:[],raw:dd(),...e}},buildMockRaw:dd});export{Ic as $,$s as B,dc as C,Nc as G,yl as H,Vc as J,qa as M,Yr as Q,Bl as S,Nr as U,Pc as W,$a as X,Hr as Y,ki as _,Zs as a,Cr as b,zc as c,Ja as d,sc as e,Js as f,sl as g,cc as h,Ws as i,Pl as j,wa as k,n as l,oc as m,Ua as n,e as o,Sc as p,Ml as q,za as r,Vl as s,zr as t,t as u,uc as v,Bc as w,fd as z}